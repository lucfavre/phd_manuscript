\documentclass[10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[french]{babel}

\usepackage{enumitem}


\usepackage{amsmath}
\usepackage{bm}

%%%PWR packages
\usepackage[Gray]{SIunits}
\usepackage[dvipsnames,pdftex,fixpdftex]{xcolor}


%\usepackage{gensymb} 


\usepackage[top=3cm, bottom=2cm, left=2cm, right=2cm]{geometry} %marges

\usepackage{tikz}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{calc}
\usetikzlibrary{math}
\usetikzlibrary{intersections,arrows.meta,bending} 

\usepackage{pgfplots}
\pgfrealjobname{draw}
\usetikzlibrary{intersections}


\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\newcommand{\npar}{\vspace{\baselineskip}}


\newcommand{\vect}[1]{\overline{\boldsymbol{#1}}}
%\newcommand{\dtime}[1]{\frac{\partial #1}{\partial t}}
\newcommand{\dpartial}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\divg}[1]{\nabla\cdot\left(#1\right)}
\newcommand{\grad}[1]{\overline{\boldsymbol{\nabla}}#1}
\newcommand{\lapla}[1]{\overline{\boldsymbol{\Delta}}#1}
%\newcommand{\tens}[1]{\overline{\overline{\boldsymbol{#1}}}}
\newcommand{\gradtens}[1]{\overline{\overline{\boldsymbol{\nabla}}}#1}
%\newcommand{\inv}[1]{\frac{1}{#1}}

\newcommand{\dtheta}{\mathrm{d}\theta}

\newcommand{\redmath}[1]{\begingroup\color{red}#1\endgroup}
\newcommand{\orangemath}[1]{\begingroup\color{orange}#1\endgroup}
\newcommand{\yellowmath}[1]{\begingroup\color{yellow}#1\endgroup}

\newcommand{\etal}{\textit{et al.}}

\pgfplotsset{compat=1.18} 



%%TO EXTRACT A FIGURE IN PDF PROPERLY CROPPED --> IN COMMAND LINE : pdflatex --jobname=forces draw.tex






\begin{document}


\beginpgfgraphicnamed{growth_analytical}


\fbox{
\begin{tikzpicture}[scale=2.0, every node/.style={scale=1.0}]


%wall
\draw[very thick] (-3.5,0) -- (2,0) ; 

%right triple contact line point
\coordinate (A) at (1,0) ; 
\draw[thick] (A) arc (-45:180+45:1.5) ; %bubble draw angles from (-alpha) to (180+alpha)

%bubble center
\coordinate (O) at ($(A)+(45+90:1.5)$) ; 
\draw (O) node[above left]{\footnotesize{$O$}};
\draw[densely dashed, <->, >=stealth] ($(O)+(-45:0.05)$) -- (A) node[midway, above]{$R$};
\draw (O) node[black]{$\times$};

%Portion angulaire de la bulle
\coordinate (T) at ($(O) + (0,1.5)$) ; %bubble top
\draw[dashed] (O) -- (T);
\coordinate(Tp) at ($(O) + (0, 1.0)$);%start for angle Theta
\draw[densely dotted, ->, >=stealth] (Tp) arc(90:0-45:1) node[midway, right] {$\varTheta$};

%Hauteur coupe
\coordinate (B) at ($(O) + (0,{-1.5*cos(45)})$);
\draw[densely dashed, <->, >=stealth] ($(O) + (0,-0.05)$) -- (B) node[midway, left] {$h$};

%Rayon du pied
\coordinate (Bl) at ($(B) + (0,-0.1)$);
\coordinate (Al) at ($(A) + (0,-0.1)$);
\draw[densely dashed, <->, >=stealth] (Bl) -- (Al) node[midway, below]{$r_{w}$};

%Vecteur surface
\coordinate (S1) at ($(O) + (50:1.5)$);
\draw[very thick, black] (S1) arc(50:50+10:1.5);
\coordinate (S2) at ($(O) + (55:1.5)$);
\draw[thick, black, ->, >=stealth] (S2)--++(50:0.4) node[midway, right]{$\textstyle{\vect{d^{2}S}}$};


%Angle de contact
\draw[color=gray!80] (A) --++(45:1) ;
\draw[densely dotted] (A)++(0.3,0) arc (0:45:0.3) ;
\draw (A)++(22.5:0.6) node{$\theta$};

%\draw (1.0,0) -- (1.530331, 0.53033) ;
%\draw (1.45433, 0.22961) node {$\alpha$};

%\draw (O) node[right] {$O$} ;
%\draw(0,1) node{$\times$};

%Couche limite interface liq/vap
\coordinate (CL) at ($(O) + (-1.5-0.2,0)$);
\draw[dashed, gray!60!black, very thick] (CL) arc(180 : 110 : 1.7);
\coordinate (Db) at ($(O) + (90+45:1.5)$);
\draw[<->, very thick, gray!60!black, >=stealth] (Db) --++(90+45:0.2) node[midway, above right]{$\delta_{b}$}
node[near end, above left,red!50!black]{$T_{L}(y)$};

\draw (Db) node[below right,red!50!black]{$T_{sat}$};

%Repere spherique
\coordinate (M) at ($(O) + (25:1.5)$);
\draw (M) node[left, black]{$M$};
\draw[->, black, thick] (M)--++(25:0.45) node[right,black]{$\vect{e_{r}}$};
\draw[->,black, thick] (M)--++(25-90:0.45) node[right,black]{$\vect{e_{\vartheta}}$};
\draw[black, thick] ($(M)+(0:0.6)$) node{$\otimes$} node[right,black]{$\vect{e_{\varphi}}$};
\draw (M) node{$\bullet$};

%Repere cartesien
\coordinate (RC) at (-4.0, 3);
\draw[->, black, thick] (RC)--++(0.2,0) node[right, black]{$\vect{e_{x}}$};
\draw[->, black, thick] (RC)--++(0,0.2) node[above, black]{$\vect{e_{y}}$};

%Profil Tliq
\coordinate (Tinf) at (-3.0, 3.5);
\coordinate (Tw) at (-2,0);
\coordinate (delta) at ($(Tinf)+(0,-3.5)$);

\draw[red!50!black, thick] (Tinf) -- (Tw) node[midway, sloped, below]{$T_{L}(y)$};
\draw[red!50!black] (Tinf) node[right]{$T_{L,bulk}<T_{sat}$};
\draw[red!50!black] (Tw) node[below]{$T_{w}>T_{sat}$};
\draw[<->,very thick, gray!60!black, >=stealth, densely dashed] ($(Tinf)+(0,-0.03)$) -- (delta) node[midway, left]{$\delta$};


\end{tikzpicture}
}

\endpgfgraphicnamed


\fbox{
\begin{tikzpicture}[scale=2.0, every node/.style={scale=1.0}]

\coordinate (Od) at (0,0);
\coordinate (Ol) at (3,0);
\coordinate (Td) at ($(Od)+(0,0.3)$);
\coordinate (Bd) at ($(Od)+(0,-0.3)$);
\coordinate (Tl) at ($(Od)+(3,0.6)$);
\coordinate (Bl) at ($(Od)+(3,-0.6)$);


\draw[black, fill=orange!80!gray!20] (Td) arc(90:90+180:0.3) -- (Bl) arc(-90:-90+180:0.6) -- cycle;
%\draw[black] (Tl) arc(90:90-180:0.6);


\draw[dashed] (Td) arc(90:90-180:0.3);
\draw[dashed] (Tl) arc(90:90+180:0.6);

\draw[<->, >=stealth, dotted] (Td)--(Bd) node[midway, left]{$D_{d}$};
\draw[<->, >=stealth, dotted] (Tl)--(Bl) node[midway, right]{$D_{l}$};


\end{tikzpicture}
}


\fbox{
\begin{tikzpicture}[scale=2.0, every node/.style={scale=1.0}]

\coordinate (Od) at (0,0);
\coordinate (Ol) at (3,0);
\coordinate (Td) at ($(Od)+(0,0.3)$);
\coordinate (Bd) at ($(Od)+(0,-0.3)$);
\coordinate (Tl) at ($(Od)+(3,0.6)$);
\coordinate (Bl) at ($(Od)+(3,-0.6)$);


\draw [dashed](0,0,0)--(1,0,0)--(1,1,0)--(0,1,0)--cycle; % face arrière
\draw (0,0,1)--(1,0,1)--(1,1,1)--(0,1,1)--cycle; % face avant%arêteshorizontales,del’arrièreversl’avant
\draw (0,0,0) -- (0,0,1); % bas gauche
\draw (1,0,0) -- (1,0,1); % bas droit
\draw (1,1,0) -- (1,1,1); % haut droit
\draw (0,1,0) -- (0,1,1); % haut gauche
\end{tikzpicture}
}

\fbox{

\begin{tikzpicture}[scale=2.0, every node/.style={scale=1.0}]

\tikzmath{\alph = 45; \ray=1; \h=\ray*cos(\alph); \alphr= \alph*pi/180;};


\draw (-2,0,-2)--(2,0,-2)--(2,0,2)--(-2,0,2)--cycle;
%\draw (0.3,0) arc (-45:180+45:0.3);

\foreach \t in {1,0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1,0,-0.1,-0.2,-0.3,-0.4,-0.5,-0.6,-0.7,-0.8,-0.9,-1} {
\draw plot[domain=-(pi-\alphr):(pi-\alphr)] ({sqrt(1-(\t)*(\t))*sin(\x r)}, {sqrt(1-(\t)*(\t))*cos(\x r)+\h}, \t);
}



\end{tikzpicture}

}


\fbox{
\begin{tikzpicture}

\tikzmath{\alph = 30; \alphr= \alph*pi/180; \thetr=pi-\alphr; \thet= \thetr*180/pi; \betr=pi/2-\alphr; \bet=\betr*180/pi ; \ray=1;   \rw=\ray*sin(\alphr r); \h=\ray*cos(\alphr r);};

\coordinate (O) at (0,0);
\coordinate (BotRight) at ($(O)+(-\bet:\ray)$);
\coordinate (BotLeft) at ($(O)+(180+\bet:\ray)$);

\shade[ball color = gray!40, opacity = 0.4] (BotRight) arc (-\bet:180+\bet:\ray);
\draw (BotRight) arc (-\bet:180+\bet:\ray);

\draw[densely dashed] (BotRight) arc (0:180:{\rw} and {\rw/3});
\draw (BotLeft) arc (180:360:{\rw} and {\rw/3});



%\draw[dashed] (BotLeft) --++(1,1);
%\draw[dashed] (BotRight) --++(1,1);


%  %\shade[ball color = gray!40, opacity = 0.4] (0,0) circle (2cm);
%  %\draw (0,0) circle (2cm);
%  \draw (-2,0) arc (180:360:2 and 0.6);
%  \draw[dashed] (2,0) arc (0:180:2 and 0.6);
%  \fill[fill=black] (0,0) circle (1pt);
%  \draw[dashed] (0,0 ) -- node[above]{$r$} (2,0);
\end{tikzpicture}
}




\newpage

\begin{tikzpicture}


\tikzmath{\alph=70; \alphrad=\alph*pi/180; \dalph=10; \dalphrad=\dalph*pi/180; \fV=0.25*(2-cos(\alphrad r)*((1+cos(\alphrad r))^2); \fSp=1-(\alphrad/pi)+(sin((2*\alphrad)r)/(2*pi)); \fspar=1.215*\dalphrad*(sin(\alphrad r)^2*(cos(\dalphrad r)^2)/((pi/2)^2-\dalphrad^2); \fGpar=(1-cos(\alphrad r)^2)*(sin(\dalphrad r));} %geometrical values

\tikzmath{\rholiq=594.3786; \nuliq=1.148*(10^(-7));} %water properties at P=155bar - Tsat




\begin{axis}[
    xmode=log,
    ymode=log,
    log ticks with fixed point,
    % for log axes, x filter operates on LOGS.
    % and log(x * 1000) = log(x) + log(1000):
    %x filter/.code=\pgfmathparse{#1 + 6.90775527898214},
]
\addplot table {
1 10
100 350
10000 2500
};
\end{axis}
\end{tikzpicture}





%%%%HFP SKETCH

\beginpgfgraphicnamed{HFP_sketch}

\fbox{

\begin{tikzpicture}[scale=3.0]

\coordinate (O) at (0,0);
\coordinate (A1) at (1,0);
\coordinate (A2) at (2,0);
\coordinate (A3) at (3,0);
\coordinate (A) at (4.5,0);

\fill[top color = blue!10!white, bottom color = red!10!white] (O)--(A)--++(0,1)--++(-4.5,0)--cycle;

\coordinate (Ob2) at (4.0,0.5);
\tikzmath{\ray=0.25;};

\fill[blue!15!white] (Ob2)--++(-\ray,0)--++(0,-0.5)--++(2*\ray,0)--++(0,0.5)--cycle;

\coordinate (Ob2) at (2.75,0);
\fill[blue!15!white] (Ob2)--++(0,1.2*\ray )--++(-2.0*\ray,0)--++(0,-1.2*\ray)--++(2.0*\ray,0)--cycle;


%Sections and wall
\draw (O) -- (A);
\draw ($(O)-(0,0.03)$) -- ($(A)-(0,0.03)$);
\foreach \i in {0,...,22}
{
\draw (\i*0.2,0) -- (\i*0.2+0.05,-0.03);
}



%\draw[dashed, gray!70!white] (A1) --++ (0,1);
%\draw[dashed, gray!70!white] (A2) --++ (0,1);
%\draw[dashed, gray!70!white] (A3) --++ (0,1);



%Flow arrows
\foreach \i in {1,...,12} 
{
\coordinate (Oloc) at ($(O)+(0,\i/13)$);
\draw[->,>=latex, gray!50!blue] (Oloc)--++({ln(1+0.05*\i)},0);
}

\draw ($(Oloc) + ({ln(1+0.05*12)},0)$) node[below right]{${\overline{U_{L}}}$};


%Liquid heat flux

\coordinate (Ophi) at (0.4,0);

\draw[->,>=latex, thick, blue!70!gray] ($(Ophi)+(0,-0.1)$)--($(Ophi)+(0,+0.1)$);
\draw ($(Ophi)+(0,-0.15)$) node{${\phi_{c,L}}$};

%
%Boiling Coal St heat flux
\coordinate (Ob) at (1.0,0);

\tikzmath{\alph = 40; \alphrad= \alph * pi / 180; \ray=0.1; \rayw = sin(\alphrad r) * \ray;}; %Geom values

\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\shade[ball color = gray!40, opacity = 0.8] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\coordinate (Ob) at (1.15,0);
\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\shade[ball color = gray!40, opacity = 0.8] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\coordinate (Oarc) at ($(Ob)+(-{\ray * sin(\alphrad r)}*0.3,0)$);

\draw[->,>=latex, thick, brown!80!black] plot [smooth, tension=0.5] coordinates {($(Oarc)+(0,-0.1)$) ($(Oarc)+(0.05,+0.03)$) ($(Oarc)+(-0.05,+0.1)$)};

\coordinate (Oarc2) at ($(Oarc) + (-2*\rayw,0)$);
\draw[->,>=latex, thick, brown!80!black] plot [smooth, tension=0.5] coordinates {($(Oarc2)+(0,-0.1)$) ($(Oarc2)+(-0.05,+0.03)$) ($(Oarc2)+(+0.05,+0.1)$)};

\draw ($(Ob)+(-0.1,-0.15)$) node{${\phi_{e,coal,st}}$};



%%Vapor convective flux
\coordinate (Ob) at (1.75,0);

\tikzmath{\alph = 40; \alphrad= \alph * pi / 180; \ray=0.2; \rw=\ray * sin(\alphrad r);};

\coordinate (Oarc) at ($(Ob)+(\rw,0)$);
\shade[ball color = gray!40, opacity = 0.8] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\draw[red, thick, densely dashed] (Oarc) --++ (-2*\rw, 0);

\draw[->,>=latex, thick, red!80!black] ($(Ob)+(0,-0.1)$)--($(Ob)+(0,+0.1)$);
\draw ($(Ob)+(0,-0.15)$) node{${\phi_{c,V}}$};



%Quenching heat flux
\coordinate (Ob2) at (2.75,0);


\tikzmath{\alph = 40; \alphrad= \alph * pi / 180;
\dalph=20; \dalphrad=\dalph*pi/180;
\alphadvrad=\alphrad - \dalphrad;
\alphrecrad=\alphrad + \dalphrad;
\ray=0.2; 
\rayadv=\ray *(1+cos(\alphrad r))/(1+ cos(\alphadvrad r);
\rayrec=\ray *(1+cos(\alphrad r))/(1+ cos(\alphrecrad r);};

%\fill[blue!15!white] (Ob2)--++(0,1.8*\ray )--++(-2.0*\ray,0)--++(0,-1.8*\ray)--++(2.0*\ray,0)--cycle;


\coordinate (Cb2) at ($(Ob2)+(0.03,{\ray * cos(\alphrad r)})$);
\draw[green!50!black,->, >=latex] (Cb2)--++({\ray+0.08},0); \draw ($(Cb2)+({\ray+0.08},0)$) node[above]{$\overline{U_{b}}$ }; %Bubble velocity


\coordinate (Oarc) at ($(Ob2)+({\ray * sin(\alphrad r)},0)$);

\shade[ball color = gray!40, opacity = 0.8] (Oarc) arc ({-(pi/2-(\alphadvrad)) r}:{(pi/2) r}:\rayadv) arc ({(pi/2) r}:{(pi+pi/2-(\alphrecrad)) r}:\rayrec);

\draw (Oarc) arc ({-(pi/2-(\alphadvrad)) r}:{(pi/2) r}:\rayadv) arc ({(pi/2) r}:{(pi+pi/2-(\alphrecrad)) r}:\rayrec);



\coordinate (w1) at ($(Oarc)+(-0.8*\ray, 2*\ray)$);
\coordinate (w2) at ($(w1) + (-\ray,-\ray)$);
\coordinate (w3) at ($(w2) + (-0.05,-0.5*\ray)$);

\draw[blue, ->, >=latex]  plot [smooth, tension=1.0] coordinates {(w1) (w2) (w3)};



\coordinate (Ob2) at (4.0,0.5);
\tikzmath{\ray=0.25;};

\shade[ball color = gray!40, opacity = 0.8] (Ob2) circle(\ray);
\draw (Ob2) circle(\ray);


\coordinate (w1) at ($(Ob2)+(-1.1*\ray,1.1*\ray)$);
\coordinate (w2) at ($(w1) + (0,-0.6)$);
\coordinate (w3) at ($(w2) + (0.2,0)$);

\draw[blue, ->, >=latex]  plot [smooth, tension=1.0] coordinates {(w1) (w2) (w3)};

\coordinate (w1) at ($(Ob2)+(+1.1*\ray,1.1*\ray)$);
\coordinate (w2) at ($(w1) + (0,-0.6)$);
\coordinate (w3) at ($(w2) + (-0.2,0)$);

\draw[blue, ->, >=latex]  plot [smooth, tension=1.0] coordinates {(w1) (w2) (w3)};



\coordinate (Ophisl) at ($(Oarc) - (\rayadv+\rayrec+0.05,0)$);
\draw[->,>=latex, thick, orange!90!gray] ($(Ophisl)+(0,-0.1)$)--($(Ophisl)+(0,+0.1)$);
\draw ($(Ophisl)+(0,-0.15)$) node{${\phi_{q}}$};



\coordinate (Ophiq) at ($(Ob2) - (0,0.5)$);
\draw[->,>=latex, thick, orange!90!gray] ($(Ophiq)+(0,-0.1)$)--($(Ophiq)+(0,+0.1)$);
\draw ($(Ophiq)+(0,-0.15)$) node{${\phi_{q}}$};


%%Boiling Coal Sl Heat Flux

\coordinate (Ob) at (3.3,0);

\tikzmath{\alph = 40; \alphrad= \alph * pi / 180; \ray=0.1; \rayw = sin(\alphrad r) * \ray;}; %Geom values

\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\shade[ball color = gray!40, opacity = 0.8] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);


%Flux to sliding bubble
\coordinate (Ophiesl) at ($(Oarc)+(-0.5,0)$);
\draw[->,>=latex, thick, brown!80!black] plot [smooth, tension=0.5] coordinates {($(Ophiesl)+(0,-0.1)$) ($(Ophiesl)+(0.05,+0.03)$) ($(Ophiesl)+(-0.05,+0.1)$)};

%Flux to static bubble
\coordinate (Oarc2) at ($(Oarc) + (-2*\rayw,0)$);
\draw[->,>=latex, thick, brown!80!black] plot [smooth, tension=0.5] coordinates {($(Oarc2)+(0,-0.1)$) ($(Oarc2)+(-0.05,+0.03)$) ($(Oarc2)+(+0.05,+0.1)$)};

\draw ($(Ob)+(-0.25,-0.15)$) node{${\phi_{e,coal,sl}}$};




\end{tikzpicture}

}

\endpgfgraphicnamed


\fbox{

\begin{tikzpicture}
\draw [red] plot [smooth cycle] coordinates {(0,0) (1,1) (3,1) (1,0) (2,-1)};

\draw [orange] plot [smooth] coordinates {(1,1) (2,2) (4,-2) (3,2)};

\draw [olive] plot [smooth,tension=0.1] coordinates {(1,1) (2,2) (4,-2) (3,2)};

\draw [blue] plot [smooth, tension=2] coordinates {(1,1) (2,2) (4,-2) (3,2)};
\end{tikzpicture}

}

\fbox{

\newcommand{\dalpha}{\text{d}\alpha}

\begin{tikzpicture}[scale=3.0, every node/.style={scale=0.7}]


\coordinate (O) at (0,0);
\coordinate (A2) at (1.4,0);
\coordinate (A) at (3.2,0);


%Sections and wall
\draw (O) -- (A);
\draw ($(O)-(0,0.05)$) -- ($(A)-(0,0.05)$);
\foreach \i in {0,...,15}
{
\draw (\i*0.2,0) -- (\i*0.2+0.1,-0.05);
}

\draw[dashed, gray!70!white] (A2) --++ (0,1);


%Non-tilded bubble
\coordinate (Ob) at (0.75,0);

\tikzmath{\alph = 40; \alphrad= \alph * pi / 180; \ray=0.5; \rw=\ray * sin(\alphrad r);};


\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

%Right angle
\draw (Oarc) --++(\alph:0.3);
\draw ($(Oarc)+(0.15,0)$) arc(0:\alph:0.15) node[near end, right]{$\alpha$};

%Left angle
\coordinate (Oarc2) at ($(Oarc) - (2*\rw,0)$);
\draw (Oarc2) --++(180-\alph:0.3);
\draw ($(Oarc2)+(-0.15,0)$) arc(180:180-\alph:0.15) node[near end, left]{$\alpha$};

%Center and radius

\coordinate (Cb) at ($(Ob)+(0,{\ray*cos(\alphrad r)} )$);
\draw (Cb) node{$\times$} node[above right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc2) node[midway, above left]{$R$};



%Tilted bubble
\coordinate (Ob2) at (2.25,0);

\tikzmath{\alph = 40; \alphrad= \alph * pi / 180;
\dalph=20; \dalphrad=\dalph*pi/180;
\alphadvrad=\alphrad - \dalphrad;
\alphrecrad=\alphrad + \dalphrad;
\ray=0.5; 
\rayadv=\ray *(1+cos(\alphrad r))/(1+ cos(\alphadvrad r);
\rayrec=\ray *(1+cos(\alphrad r))/(1+ cos(\alphrecrad r);};

\coordinate (Oarc) at ($(Ob2)+({\ray * sin(\alphrad r)},0)$);


\draw (Oarc) arc({-(pi/2-(\alphadvrad)) r}:{(pi/2) r}:\rayadv) arc ({(pi/2) r}:{(pi+pi/2-(\alphrecrad)) r}:\rayrec);

%Right angle
\draw (Oarc) --++(\alphadvrad r:0.3);
\draw ($(Oarc)+(0.15,0)$) arc(0:\alphadvrad r:0.15) node[very near end, right]{$\alpha - \dalpha$};

%Left angle
\coordinate (Oarc2) at ($(Oarc) - ({\rayadv * sin(\alphadvrad r) + \rayrec * sin(\alphrecrad r)},0)$);
\draw (Oarc2) --++({180-(\alphrecrad r)}:0.3);
\draw ($(Oarc2)+(-0.15,0)$) arc(180:{180-(\alphrecrad r)}:0.15) node[midway, left]{$\alpha + \dalpha $};



%Center and radius

\coordinate (Cb) at ($(Oarc)+( -{0.5 * (\rayadv * sin(\alphadvrad r) + \rayrec  * sin(\alphrecrad r) } , {\ray * cos(\alphrad r)} )$);
\draw (Cb) node{$\times$} node[below right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc2) node[midway, above left]{$R$};


%Inclination angle

\draw[densely dotted] (Cb) --++ (0,0.7);
\draw[densely dotted] (Cb) --++ ({90 - (1*\dalphrad r)}: 0.7 );
\draw ($(Cb) + (0,0.3)$) arc(90: {90 - (\dalphrad r)}:0.3)  node[midway, above]{$\dalpha$};



%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(A2)+(0.05,\i/15)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++({ln(1+0.03*\i)},0);
}



\end{tikzpicture}

}




\fbox{

\newcommand{\dalpha}{\text{d}\alpha}

\begin{tikzpicture}[scale=3.0, every node/.style={scale=0.7}]


\coordinate (O) at (0,0);
\coordinate (A2) at (1.4,0);
\coordinate (A) at (2,0);


%Sections and wall
\draw (O) -- (A);
\draw ($(O)-(0,0.05)$) -- ($(A)-(0,0.05)$);
\foreach \i in {0,...,9}
{
\draw (\i*0.2,0) -- (\i*0.2+0.1,-0.05);
}

%\draw[dashed, gray!70!white] (A2) --++ (0,1);


%Non-tilded bubble
\coordinate (Ob) at (1.3,0);

\tikzmath{\alph = 40; \alphrad= \alph * pi / 180; \ray=0.5; \rw=\ray * sin(\alphrad r);};


\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

%%Right angle
\draw (Oarc) --++(\alph:0.3);
\draw ($(Oarc)+(0.15,0)$) arc(0:\alph:0.15) node[near end, right]{$\alpha$};

%%Left angle
%\coordinate (Oarc2) at ($(Oarc) - (2*\rw,0)$);
%\draw (Oarc2) --++(180-\alph:0.3);
%\draw ($(Oarc2)+(-0.15,0)$) arc(180:180-\alph:0.15) node[near end, left]{$\alpha$};

%Center and radius

\coordinate (Cb) at ($(Ob)+(0,{\ray*cos(\alphrad r)} )$);
\draw (Cb) node{$\times$} node[above right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc) node[midway, above right]{$R$};




%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(O)+(-0.1,\i/15)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++({ln(1+0.03*\i)},0);
}

%Liquid flow

\coordinate (TopB) at ($(Cb)+(0,{\ray+0.05})$);
\coordinate (TopLeftB) at ($(Cb) + ({90+\alph}:{\ray+0.05})$);
\coordinate (LeftB) at ($(Cb)+({-\ray-0.05},0)$);

%\draw (TopB) -- (LeftB);

\draw [->, >=latex, blue!70!black] plot [smooth, tension=1.0] coordinates {(TopB) (TopLeftB) (LeftB)}; \draw (TopB) node[above]{$T_{l}(y^{+}_{b})$};

\coordinate (Sp1) at (0.5,{\ray/2});
\coordinate (Sp2) at (0.75,{\ray/2});

\tikzmath{\rayspi=0.1;};

\draw[->,>=stealth,blue!70!black] plot[domain=0:3.2,smooth,xshift=9,yshift=3] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;
\draw[->,>=stealth,blue!70!black] plot[domain=0:3.2,smooth,xshift=17,yshift=8] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;

%\draw [orange] plot [smooth] coordinates {(1,1) (2,2) (4,-2) (3,2)};

%Bubble velocity

\draw[red,->, >=latex] (Cb)--++({\ray+0.07},0) node[above]{ $\overline{U_{b}}$ };


\end{tikzpicture}

}

\fbox{

\begin{tikzpicture}[scale=4.0]

\tikzmath{\rayspi=0.2;};

\coordinate (Cspi) at (0,0);
\coordinate (Dspi) at ($(Cspi)+(0,\rayspi)$);

\draw[->] plot[domain=0:3,smooth] ({(\x *pi) r}:{\rayspi*(1-\x/4)}) ;
%{
%\draw plot[domain=-(pi-\alphr):(pi-\alphr)] ({sqrt(1-(\t)*(\t))*sin(\x r)}, {sqrt(1-(\t)*(\t))*cos(\x r)+\h}, \t);
%}



\end{tikzpicture}
}


\fbox{

\begin{tikzpicture}[scale=2.0]

\tikzmath{\length=3; \diam=0.6;};

\coordinate (A1) at (0,0);
\coordinate (A2) at ($(A1) + (0,\length)$);
\coordinate (B1) at (\diam,0);
\coordinate (B2) at ($(B1)+(0,\length)$);

\draw (A1) -- (A2);
\draw (B1) -- (B2);

\draw [->, >=latex, blue!70!black] ($(A1)+({\diam / 2},0)$) --++ (0,0.4) node[very near start, below right]{$U_{e}$};


\foreach \z in {1,...,4}
{
\coordinate (P1) at (0,{\z * \length / 5});
\coordinate (P2) at (\diam, {\z * \length / 5});

\draw[->, >=latex, red!80!black] ($(P1)+(-0.4,0)$) -- (P1);
\draw[->, >=latex, red!80!black] ($(P2)+(0.4,0)$) -- (P2);

}


\draw[red!80!black] (0,{\length / 2}) node[left]{$\phi_{w}$};
\draw[red!80!black] (\diam,{\length / 2}) node[right]{$\phi_{w}$};

\draw[orange!50!black, densely dotted] (P1)--(P2) node[very near end, above right]{\footnotesize{~Mesures}};

\draw[green!50!black, densely dashed, <->,>=latex] ($(B1)+(0.5,0)$) -- ($(P2) + (0.5,0)$) node[midway,right]{$L_{heat}$};

\tikzmath{\bubrad=0.03;};
\foreach \i in {1,...,10}
{

\draw ({\bubrad+rnd*(\diam-2*\bubrad)}, {\length / 2 + rnd*\length /2}) circle(\bubrad);

\draw ({\bubrad+rnd*(\diam-2*\bubrad)}, {\length / 2 + rnd*\length /2}) circle(\bubrad);

\draw ({\bubrad+rnd*(\diam-2*\bubrad)}, {\length / 2 + rnd*\length /2}) circle(\bubrad);


}


\end{tikzpicture}


}



\fbox{

\begin{tikzpicture}

\node[draw] (phiw) at (0,0){$\phi_{w}$};

%HFP
\node[draw] (phicl) at (2,2){$\phi_{c,L}$};
\node[draw] (phicv) at (2,1){$\phi_{c,V}$};
\node[draw] (phiq) at (2,-1){$\phi_{q}$};
\node[draw] (phie) at (2,-2){$\phi_{e}$};

\draw[<-, >=latex] (phiw) to (phicl);
\draw[<-, >=latex] (phiw) to (phicv);
\draw[<-, >=latex] (phiw) to (phiq);
\draw[<-, >=latex] (phiw) to (phie);

%phicl
\node[draw] (acl) at (,2){$\phi_{c,L}$};
\node[draw] (hcl) at (2,1){$\phi_{c,V}$};
\node[draw] (Tliq) at (2,-1){$\phi_{q}$};
\node[draw] (Tw) at (2,-2){$\phi_{e}$};




\end{tikzpicture}

}







\fbox{


\begin{tikzpicture}[scale=3.0, every node/.style={scale=0.7}]


%%%Truncated sphere on a vertical wall

\coordinate (O1) at (0,0);
\coordinate (O2) at (0,2);

\draw (O1)--(O2);

\coordinate (Ob) at (0,1.0);

\tikzmath{\thet = 45; \thetrad= \thet * pi / 180; \ray=0.5; \rw=\ray * sin(\thetrad r);};


\coordinate (Oarc) at ($(Ob)-(0,{\ray * sin(\thetrad r)})$);
\draw (Oarc) arc({(-pi+\thetrad ) r}:{(pi-\thetrad ) r}:\ray);

%Upstream angle
\draw (Oarc) --++(-90+\thet:0.3);
\draw ($(Oarc)+(0,-0.15)$) arc(-90:-90+\thet:0.15) node[near end, below]{$\theta$};

%%Downstream angle
%\coordinate (Oarc2) at ($(Oarc) - (2*\rw,0)$);
%\draw (Oarc2) --++(180-\thet:0.3);
%\draw ($(Oarc2)+(-0.15,0)$) arc(180:180-\thet:0.15) node[near end, left]{$\alpha$};

%Center and radius

\coordinate (Cb) at ($(Ob)+({\ray*cos(\thetrad r)},0 )$);
\draw (Cb) node{$\times$} node[below right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc) node[midway, below right]{$R$};


%%Forces

\draw[->, >=latex, violet!70!black] (Ob)--++(\ray/2,0) node[near end, above]{$\vect{F_{CP}}$};

\draw[->, >=latex, red!70!black!] ($(Cb)+(\ray,0)$)--++(\ray/2,0) node[very near end, above]{$\vect{F_{L}}$};
\draw[->, >=latex, red!70!black!] ($(Cb)+(0,\ray)$)--++(0,\ray/2) node[very near end, right]{$\vect{F_{D}}$};

\coordinate (Oarc2) at ($(Oarc)+(0,{2*\rw})$);
\draw[->, >=latex, violet] (Oarc)--++(90+\thet:\ray/2) node[very near end, above]{$\vect{F_{C}}$};
\draw[->, >=latex, violet] (Oarc2)--++(-90-\thet:\ray/2) node[very near end, below]{$\vect{F_{C}}$};

\draw[->, >=latex, blue!70!black] (Cb)--++(0,\ray/1.5) node[very near end, right]{$\vect{F_{B}}$};


\draw[->, >=latex, green!50!black!] (Cb)--++(90+\thet/1.5:\ray/1.5) node[very near end, above]{$\vect{F_{AM}}$};

%Gravity

\draw[->, >=latex, blue!30!black]  ($(Cb)+({1.5*\ray},{1.5*\ray})$)--++(0,-\ray/2) node[very near end, right]{$\vect{g}$};


%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(O1)+(\i/15,0.05)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++(0,{ln(1+0.03*\i)});
}





%Tilted bubble
\coordinate (Ob2) at (2.5,1.0);

\coordinate (O1) at (2.5,0);
\coordinate (O2) at (2.5,2);
\draw (O1)--(O2);

\tikzmath{\thet = 40; \thetrad= \thet * pi / 180;
\dthet=10; \dthetrad=\dthet*pi/180;
\thetadvrad=\thetrad - \dthetrad;
\thetrecrad=\thetrad + \dthetrad;
\thetadv=\thetadvrad*180/pi;
\thetrec=\thetrecrad*180/pi;
\ray=0.5; 
\rayadv=\ray *(1+cos(\thetrad r))/(1+ cos(\thetadvrad r);
\rayrec=\ray *(1+cos(\thetrad r))/(1+ cos(\thetrecrad r);};

\coordinate (Oarc) at ($(Ob2)-(0,{\ray * sin(\thetrad r)})$);


\draw (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);

%Upstream angle
\draw (Oarc) --++(-90+\thetrecrad r:0.3) node[very near end, below]{$\theta + \dtheta$};
\draw ($(Oarc)+(0,-0.15)$) arc(-90:-90+\thetrecrad r:0.15) ;

%Downstream angle
\coordinate (Oarc2) at ($(Oarc) + (0,{\rayadv * sin(\thetadvrad r) + \rayrec * sin(\thetrecrad r)})$);
\draw (Oarc2) --++({90-(\thetadvrad r)}:0.3);
\coordinate (angadv) at ($(Oarc2) +({90-(\thetadvrad r)}:0.3)$);
\draw (angadv)  node[above]{$\theta - \dtheta $};
\draw ($(Oarc2)+(0,+0.15)$) arc(90:{90-(\thetadvrad r)}:0.15);



%Center and radius

\coordinate (Cb) at ($(Oarc2)+( {\ray * cos(\thetrad r)} , {-0.5 * (\rayadv * sin(\thetadvrad r) + \rayrec  * sin(\thetrecrad r) )})$);
\draw (Cb) node{$\times$} node[below right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc) node[midway, above left]{$R$};


%Inclination angle

%\draw[densely dotted] (Cb) --++ (0.7,0);
%\draw[densely dotted] (Cb) --++ ({(1*\dthetrad r)}: 0.7 );
%\draw ($(Cb) + (0.3,0)$) arc(0: {(\dthetrad r)}:0.3)  node[midway, right]{$\dtheta$};




%%Forces

\draw[->, >=latex, violet!70!black] (Ob2)--++(\ray/2,0) node[near end, above]{$\vect{F_{CP}}$};

\draw[->, >=latex, red!70!black!] ($(Cb)+(\ray,0)$)--++(\ray/2,0) node[very near end, above]{$\vect{F_{L}}$};
\draw[->, >=latex, red!70!black!] ($(Cb)+(0,-\rayadv*0.95)$)--++(0,-\ray/2) node[very near end, right]{$\vect{F_{D}}$};
\draw[->, >=latex, red] ($(Cb)+(0,+\rayrec*1.04)$)--++(0,+\ray/2) node[very near end, right]{$\vect{U_{b}}$};


\draw[->, >=latex, violet] (Oarc)--++(90+\thetrec:\ray/2) node[very near end, above]{$\vect{F_{C}}$};
\draw[->, >=latex, violet] (Oarc2)--++(-90-\thetadv:\ray/2) node[very near end, below]{$\vect{F_{C}}$};

\draw[->, >=latex, blue!70!black] (Cb)--++(0,\ray/1.5) node[very near end, right]{$\vect{F_{B}}$};


\draw[->, >=latex, green!50!black!] (Cb)--++(90-\thet:-\ray/1.5) node[very near end, right]{$\vect{F_{AM}}$};

%Gravity

\draw[->, >=latex, blue!30!black]  ($(Cb)+({1.5*\ray},{1.5*\ray})$)--++(0,-\ray/2) node[very near end, right]{$\vect{g}$};



%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(O1)+(\i/15,0.05)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++(0,{ln(1+0.03*\i)});
}



\end{tikzpicture}

}




\fbox{

\begin{tikzpicture}[scale=3.0, every node/.style={scale=0.7}]


\coordinate (O) at (0,0);
\coordinate (A2) at (1.6,0);
\coordinate (A) at (3.2,0);


%Sections and wall
\draw (O) -- (A2);
\draw ($(O)-(0,0.05)$) -- ($(A2)-(0,0.05)$);
\foreach \i in {0,...,7}
{
\draw (\i*0.2,0) -- (\i*0.2+0.1,-0.05);
}


%Non-tilded bubble
\coordinate (Ob) at (0.75,0);

\tikzmath{\alph = 0; \alphrad= \alph * pi / 180; \ray=0.5; \rw=\ray * sin(\alphrad r);};


\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\tikzmath{\raybis= 0.8*\ray;}
\coordinate (Oarc) at ($(Ob)+({\raybis * sin(\alphrad r)},0)$);
\draw[loosely dashed] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\raybis);


\coordinate (Oarc2) at ($(Oarc) - (2*\rw,0)$);

%Center and radius

\coordinate (Cb) at ($(Ob)+(0,{\ray*cos(\alphrad r)} )$);
\draw (Cb) node{$\times$} node[above right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc2) node[midway, above left]{$R$};


%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(O)+(-0.1,\i/15)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++({ln(1+0.03*10)},0);
}

\draw ($(Oloc) + ({ln(1+0.05*7)},0)$) node[below right]{${\overline{U_{L}}}$};

\draw[red, thick, ->, >=stealth] (Cb)--++(0.35*\ray,-0.65*\ray) node[midway, right] {$\redmath{\vect{F_{AM}}}$};

\end{tikzpicture}

}





\fbox{

\begin{tikzpicture}[scale=3.0, every node/.style={scale=0.7}]


\coordinate (O) at (0,0);
\coordinate (A2) at (1.6,0);
\coordinate (A) at (3.2,0);


%Sections and wall
\draw[dotted] (O) -- (A2);


%Non-tilded bubble
\coordinate (Ob) at (0.75,0);

\tikzmath{\alph = 90; \alphrad= \alph * pi / 180; \ray=0.5; \rw=\ray * sin(\alphrad r);};


\tikzmath{\raybis= 0.8*\ray;}
\coordinate (Oarc) at ($(Ob)+({\raybis * sin(\alphrad r)},0)$);
\draw[loosely dashed] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\raybis);

\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);




\coordinate (Oarc2) at ($(Oarc) - (2*\rw,0)$);

%Center and radius

\coordinate (Cb) at ($(Ob)+(0,{\ray*cos(\alphrad r)} )$);
\draw (Cb) node{$\times$} node[above right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) --++($({\ray*sin(-45)},{\ray*cos(-45)})$) node[midway, below left]{$R$};

\draw (Oarc)--++(-2*\ray,0);

\draw[red, thick, ->, >=stealth] ($(Cb)+(0,\ray)$)--++(0,-0.75*\ray) node[midway, right] {$\redmath{\vect{F_{AM}}}$};


\end{tikzpicture}

}




%
%\beginpgfgraphicnamed{forces} %%IN COMMAND LINE : pdflatex --jobname=forces draw.tex


\fbox{


\begin{tikzpicture}[scale=3.5, every node/.style={scale=0.9}]


%%%%Truncated sphere on a vertical wall


%Tilted bubble
\coordinate (Ob2) at (2.5,1.0);

\coordinate (O1) at (2.5,0);
\coordinate (O2) at (2.5,2);
\draw (O1)--(O2);

\tikzmath{\thet = 40; \thetrad= \thet * pi / 180;
\dthet=10; \dthetrad=\dthet*pi/180;
\thetadvrad=\thetrad - \dthetrad;
\thetrecrad=\thetrad + \dthetrad;
\thetadv=\thetadvrad*180/pi;
\thetrec=\thetrecrad*180/pi;
\ray=0.5; 
\rayadv=\ray *(1+cos(\thetrad r))/(1+ cos(\thetadvrad r);
\rayrec=\ray *(1+cos(\thetrad r))/(1+ cos(\thetrecrad r);};

\coordinate (Oarc) at ($(Ob2)-(0,{\ray * sin(\thetrad r)})$);


\draw (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);

%Upstream angle
\draw (Oarc) --++(-90+\thetrecrad r:0.3) node[very near end, below]{$\theta + \dtheta$};
\draw ($(Oarc)+(0,-0.15)$) arc(-90:-90+\thetrecrad r:0.15) ;

%Downstream angle
\coordinate (Oarc2) at ($(Oarc) + (0,{\rayadv * sin(\thetadvrad r) + \rayrec * sin(\thetrecrad r)})$);
\draw (Oarc2) --++({90-(\thetadvrad r)}:0.3);
\coordinate (angadv) at ($(Oarc2) +({90-(\thetadvrad r)}:0.3)$);
\draw (angadv)  node[above]{$\theta - \dtheta $};
\draw ($(Oarc2)+(0,+0.15)$) arc(90:{90-(\thetadvrad r)}:0.15);



%Center and radius

\coordinate (Cb) at ($(Oarc2)+( {\ray * cos(\thetrad r)} , {-0.5 * (\rayadv * sin(\thetadvrad r) + \rayrec  * sin(\thetrecrad r) )})$);
\draw (Cb) node{$\times$} node[below right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc) node[midway, above left]{$R$};


\draw[densely dashed, <->, >=latex] ($(Oarc) + (-\ray/12,+\ray/15) $) -- ($(Oarc2) + (-\ray/12,-\ray/6) $) node[midway, left]{$d_{w}$};



%Inclination angle

\draw[densely dotted] (Cb) --++ (\ray,0);
\draw[densely dotted] (Cb) --++ ({(1*\dthetrad r)}: \ray );
\draw ($(Cb) + (0.3,0)$) arc(0: {(\dthetrad r)}:0.3)  node[very near end, above]{$\dtheta$};





%%Forces

\draw[->, >=latex, violet!70!black] (Ob2)--++(\ray/2,0) node[near end, above]{$\vect{F_{CP}}$};

\draw[->, >=latex, red!70!black!] ($(Cb)+(\ray,0)$)--++(\ray/2,0) node[very near end, above]{$\vect{F_{L}}$};
\draw[->, >=latex, red!70!black!] ($(Cb)+({sin(5)},{cos(5)*\rayrec*1.04})$)--++(0,+\ray/2) node[very near end, right]{$\vect{F_{D}}$};
\draw[->, >=latex, red] ($(Cb)+(0,+\rayrec*1.04)$)--++(0,+\ray/1.5) node[very near end, left]{$\vect{U_{b}}$};


\draw[->, >=latex, violet] (Oarc)--++(90+\thetrec:\ray/2) node[very near end, left]{$\vect{F_{C}}$};
\draw[->, >=latex, violet] (Oarc2)--++(-90-\thetadv:\ray/2) node[very near end, left]{$\vect{F_{C}}$};

\draw[->, >=latex, blue!70!black] (Cb)--++(0,\ray/1.5) node[very near end, right]{$\vect{F_{B}}$};


\draw[->, >=latex, green!50!black!] (Cb)--++(160-\thet:\ray/1.5) node[very near end, above]{$\vect{F_{AM}}$};

%Gravity

\draw[->, >=latex, blue!30!black]  ($(Cb)+({1.5*\ray},{1.5*\ray})$)--++(0,-\ray/2) node[very near end, right]{$\vect{g}$};



%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(O1)+(\i/15,0.05)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++(0,{ln(1+0.03*\i)});
}
\draw[gray!70!blue] ($(Oloc)+(0.1,0.1)$) node{$\vect{U_{L}}$};

%%Referential vectors
\coordinate (Ovect) at (4.0,0);
\draw[->, >=latex] (Ovect)--++(0.3,0) node[very near end, above right]{$\vect{e_{y}}$};
\draw[->, >=latex] (Ovect)--++(0,0.3) node[very near end, above right]{$\vect{e_{x}}$};

%Control volume

\coordinate (Oarc) at ($(Ob2)-(0,{\ray * sin(\thetrad r)})$);
\coordinate (Oarcb) at ($(Oarc)+(-\thetrecrad r : 0.15*\rayrec)$);

\draw[thick] (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);
\draw[dotted, green!50!black, opacity=0.7, line width = 3pt] (Oarcb) arc({-pi+(1.15*\thetrecrad)) r}:{0.3 r}:1.01*\rayrec) arc ({0.3 r}:{ 0.93*(pi-(\thetadvrad)) r}:1.01*\rayadv)--cycle;

\end{tikzpicture}



}


%\endpgfgraphicnamed



%\beginpgfgraphicnamed{shi_scheme}

\fbox{

\begin{tikzpicture}[scale=3.0, every node/.style={scale=0.7}]


\coordinate (O) at (0,0);
\coordinate (A2) at (2.0,0);
\coordinate (A) at (3.2,0);


%Sections and wall
\draw (O) -- (A2);
\draw ($(O)-(0,0.05)$) -- ($(A2)-(0,0.05)$);
\foreach \i in {0,...,9}
{
\draw (\i*0.2,0) -- (\i*0.2+0.1,-0.05);
}


%Parameters
\coordinate (Ob) at (1.2,0.7);

\coordinate (Ow) at (1.2,0);


\tikzmath{\alph = 0; \alphrad= \alph * pi / 180; \ray=0.5; \rw=\ray * sin(\alphrad r);};

%Viscous influence zone

\draw[dashed, black, very thick] (Ob) circle(\ray);

\fill[color = blue!20!white, opacity=0.5] (Ob) circle(\ray);

%bubble

\draw[black, very thick] (Ob) circle({\ray/1.5});

\fill[white] (Ob) circle({\ray/1.5});

\draw (Ob) node{$\times$} ; % node[above right]{$O$};

\draw[densely dashed, <->, >=latex] (Ob) --++ (0,+\ray/1.5) node[midway, left]{$R$};

\draw[densely dashed, <->, >=latex] (Ob) -- (Ow) node[very near end, right]{$y=R\times L_{R}$};


\draw[densely dashed, <->, >=latex] (Ob) --++ (45:\ray) node[above right]{$\dfrac{\nu_{L}}{\left| U_{rel} \right|}=\dfrac{y}{L_{u}}$};




%Center and radius


%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(O)+(-0.1,\i/15)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++({ln(1+0.03*\i)},0);
}



\draw[gray!70!blue] ($(Oloc)+(0.1,0.1)$) node{$\vect{U_{L}}$};




\end{tikzpicture}

}



%\endpgfgraphicnamed


%%\beginpgfgraphicnamed{newbub_sugrue}


\fbox{


\begin{tikzpicture}[scale=3.5, every node/.style={scale=0.9}]


%%%%Truncated sphere on a vertical wall


%Tilted bubble
\coordinate (Ob2) at (2.5,1.0);

\coordinate (O1) at (2.5,0);
\coordinate (O2) at (2.5,2);
\draw (O1)--(O2);

\tikzmath{\thet = 30 ; \thetrad= \thet * pi / 180;
\dthet= 25 ; \dthetrad=\dthet*pi/180;
\thetadvrad=\thetrad - \dthetrad;
\thetrecrad=\thetrad + \dthetrad;
\thetadv=\thetadvrad*180/pi;
\thetrec=\thetrecrad*180/pi;
\ray=0.5; 
\rayadv=\ray *(1+cos(\thetrad r))/(1+ cos(\thetadvrad r);
\rayrec=\ray *(1+cos(\thetrad r))/(1+ cos(\thetrecrad r);};

\coordinate (Oarc) at ($(Ob2)-(0,{\ray * sin(\thetrad r)})$);


\draw (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);




\end{tikzpicture}

}

%
%\beginpgfgraphicnamed{wettability}
%
\fbox{

\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.5,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}


%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[blue!10!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--++(1.5,0);

\coordinate (Ob) at ($(O) + (2.5,0)$);

\tikzmath{\alph = 20; \alphrad= \alph * pi / 180; \ray=0.6; \rw=\ray * sin(\alphrad r);};

\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\draw[fill=gray!10!white] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

%%Right angle
\draw (Oarc) --++(\alph:0.3) node[very near end, right]{$\theta$};
\draw ($(Oarc)+(0.15,0)$) arc(0:\alph:0.15) ;

\draw ($(cavC) + (0,1.2)$) node{High wettability, low $\theta$};

\draw (cavC)  node[below]{Flooded cavity};

\draw[dashed] (sep)--++(0,2);




\coordinate (O) at ($(sep)+(0.05,0)$);
\coordinate (Oliq) at ($(O)+(0,0.1)$);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);

\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (cavCgas) at ($(cavC)+(+45:0.3)$);

\coordinate (Oend) at ($(cavR)+(0.5,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}

%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.35)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[blue!10!white] (sep)--(cavL)--(cavC)--(cavR)--($(Oend)+(1.6,0)$)--($(Oend)+(1.6,2)$)--($(sep)+(0,2)$)--cycle;


\fill[white] (cavC) circle(0.3);

\draw (cavC)  node[below]{Trapped gas};

\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--++(1.6,0);


\coordinate (Ob) at ($(O) + (2.6,0)$);

\tikzmath{\alph = 120; \alphrad= \alph * pi / 180; \ray=0.6; \rw=\ray * sin(\alphrad r);};

\coordinate (Oarc) at ($(Ob)+({\ray * sin(\alphrad r)},0)$);
\draw[fill=gray!10!white] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

%%Right angle
\draw (Oarc) --++(\alph:0.3) node[very near end, right]{$\theta$};
\draw ($(Oarc)+(0.15,0)$) arc(0:\alph:0.15) ;

\draw ($(cavC) + (0,1.2)$) node{Low wettability, high $\theta$};

\end{tikzpicture}

}


%\endpgfgraphicnamed



%\beginpgfgraphicnamed{bub_life_VFB}


\fbox{


\begin{tikzpicture}[scale=3.5, every node/.style={scale=0.9}]


%%%%Bubble growth, sliding and lift-off in VFB


%Tilted bubble
\coordinate (Ow1) at (0,0.5);
\coordinate (Ow2) at (0,3);

\coordinate (Osit1) at (0,0.95);
\coordinate (Osit) at (-0.05,1);
\coordinate (Osit2) at (0,1.05);

\coordinate (Oslide) at (0,1.5);
\coordinate (Olo) at (0,2.5);


\coordinate (Obsit) at (0,1.0);

\draw (Ow1)--(Osit1)--(Osit)--(Osit2)--(Ow2);

\tikzmath{\thet = 30 ; \thetrad= \thet * pi / 180;
\dthet= 10 ; \dthetrad=\dthet*pi/180;
\thetadvrad=\thetrad - \dthetrad;
\thetrecrad=\thetrad + \dthetrad;
\thetadv=\thetadvrad*180/pi;
\thetrec=\thetrecrad*180/pi;
\ray=0.15; 
\rayadv=\ray *(1+cos(\thetrad r))/(1+ cos(\thetadvrad r);
\rayrec=\ray *(1+cos(\thetrad r))/(1+ cos(\thetrecrad r);};

\coordinate (Oarc) at ($(Obsit)-(0,{\ray * sin(\thetrad r)})$);

%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(Ow1)+(\i/15,0.05)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++(0,{ln(1+0.03*\i)});
}

\draw (Oloc) node[gray!70!blue, above right]{${\vect{U_{L}}}$};

\draw[densely dashed, black, <->] (Osit)--($(Olo)-(0.05,0)$) node[midway, left]{$l_{sl}$};

\draw ($(Osit)+(-0.05,0)$) node[left]{$t_{g,d}$};

\draw ($(Olo)+(-0.05,0)$) node[left]{$t_{g,lo}$};

%Static growth

\draw (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);

\fill[color = gray!10!white, opacity=0.5] (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);

\draw[<->, densely dashed] ($(Osit) + ({\ray * cos(\thetadvrad r)+0.05},0)$) --++ (\rayadv, 0) node[very near end, right]{$R_{d}$};

%Sliding
\coordinate (Oarc) at ($(Oslide)+(0,{\ray * sin(\thetrad r)})$);
\tikzmath{\ray=0.2;};

\draw (Oarc) arc({(-pi+\thetrad) r}:{(pi-\thetrad) r}:\ray);
\fill[color = gray!10!white, opacity=0.5] (Oarc) arc({(-pi+\thetrad) r}:{(pi-\thetrad) r}:\ray);

\draw[->, red] ($(Oslide) + ({\ray * cos(\thetadvrad r)},\ray)$) --++ (0, {1.5*\ray}) node[very near end, right]{$\redmath{\vect{U_{b}}}$};


%Lift-off

\coordinate (Ob) at ($(Olo)+(0.6, 0)$);
\tikzmath{\ray=0.3;};

\draw (Ob) circle(\ray);
\fill[color = gray!10!white, opacity=0.5] (Ob) circle(\ray);

\draw[<->, densely dashed] (Ob) --++ (\ray, 0) node[midway, above]{$R_{lo}$};

\draw ($(Ob)+(0,0.7)$) node{Side view};


%%Quenched Area

\tikzmath{\rayd=0.15; \raylo=0.3;}; 

\coordinate (Od) at (2, 1);
\coordinate (Ol) at (2, 2.5);
\coordinate (Rd) at ($(Od)+(\rayd,0.0)$);
\coordinate (Ld) at ($(Od)+(- \rayd,0)$);
\coordinate (Rl) at ($(Ol)+(\raylo,0.0)$);
\coordinate (Ll) at ($(Ol)+(- \raylo, 0.0)$);
%arc(-90:-90+180:0.6)

\draw[black] (Ld) arc(180:360:\rayd) -- (Rl) arc(360:360+180:\raylo) -- cycle;
\shade[bottom color=orange!90!blue, top color=red!90!blue, opacity=0.3] (Ld) arc(180:360:\rayd) -- (Rl) arc(360:360+180:\raylo) -- cycle;
%\draw[black] (Tl) arc(90:90-180:0.6);


\draw[densely dotted] (Ld) arc(180:0:\rayd);
\draw[densely dotted] (Ll) arc(180:360:\raylo);

\draw[<->, >=stealth, densely dashed] (Od)--(Rd) node[midway, below]{$R_{d}$};
\draw[<->, >=stealth, densely dashed] (Ol)--(Rl) node[midway, above]{$R_{lo}$};

\draw[<->, >=stealth, densely dashed] (Od)--(Ol) node[midway, left]{$l_{sl}$};

\coordinate (Ow1) at (1.5,0.5);
\coordinate (Ow2) at (1.5,3);
\coordinate (Ow3) at (2.5,3);
\coordinate (Ow4) at (2.5,0.5);

\draw (Ow1) -- (Ow2) -- (Ow3) -- (Ow4) -- cycle;
\draw ($(Ol)+(0,0.7)$) node{Top view};

\end{tikzpicture}

}



%\endpgfgraphicnamed


%\beginpgfgraphicnamed{FIP}



\begin{tikzpicture}
\begin{axis}[
width=10cm,
height=4cm,
x axis line style={-stealth},
y axis line style={-stealth},
xticklabels={0, $T$},
ymax = 1.2,
xmax=1.05,
axis lines=center,
ytick={0,1},
xtick={0,1},
xlabel={Time},
ylabel={Vapor FIP},
xlabel near ticks,
ylabel near ticks]
\addplot+[thick,mark=none,const plot]
coordinates
{(0,0) (0.1,0) (0.1,1) (0.3,1) (0.3,0) (0.6,0) (0.6,1) (0.65,1) (0.65,0) (0.70,0) (0.70,1) (0.8,1) (0.8,0) (1, 0)};
%
\addplot[mark=none, <->]
coordinates
{(0.11, 0.5) (0.29, 0.5)} node[midway, above]{$t_{V}$};
\addplot[mark=none, <->]
coordinates
{(0.31, 0.3) (0.59, 0.3)} node[midway, above]{$t_{L}$};
\end{axis}
\end{tikzpicture}
%
%\endpgfgraphicnamed



%%%%BUBBLE INTERACTIONS



\beginpgfgraphicnamed{static}


\begin{tikzpicture}[scale=4.0, every node/.style={scale=0.9}]


%%%%Site deactivation

\tikzmath{
\ray=0.15;
\xmin = -0.1;
\xmax = 1.15;
};

\draw (\xmin,\xmin)--(\xmin,\xmax)--(\xmax,\xmax)--(\xmax,\xmin)--cycle;






\draw(0.35,0.21) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.35,0.21) circle(\ray);
\draw(0.35,0.21) node{$\times$};


\draw(0.49,0.61) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.49,0.61) circle(\ray);
\draw(0.49,0.61) node{$\times$};


\draw(0.72,0.13) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.72,0.13) circle(\ray);
\draw(0.72,0.13) node{$\times$};
\draw[<->, >=latex](0.72, 0.13)--++(\ray,0) node[midway, below]{$R_{d}$};


\draw(0.17,0.13) node{$\times$};

\draw(0.80,0.42) node{$\times$};

\draw(0.5,0.90) node{$\times$};

\draw(0.10,0.38) node{$\times$};



\draw(0.17,0.69) circle(\ray);
\fill[color = olive!25!white, opacity=0.5] (0.17,0.69) circle(\ray);
\draw(0.17,0.69) node{$\times$};


\draw(0.21,0.85) circle(\ray);
\fill[color = olive!25!white, opacity=0.5] (0.21,0.85) circle(\ray);
\draw(0.21,0.85) node{$\times$};




\draw(0.73,0.82) circle(\ray);
\fill[color = olive!25!white, opacity=0.5] (0.73,0.82) circle(\ray);
\draw(0.73,0.82) node{$\times$};


\draw(0.95,0.76) circle(\ray);
\fill[color = olive!25!white, opacity=0.5] (0.95,0.76) circle(\ray);
\draw(0.95,0.76) node{$\times$};

%%Legend
\tikzmath{
\legshift=0.1;
}

\draw[fill=gray!15!white](\xmax+0.05, \xmax-0.05) circle(0.02) node[right]{ : Single bubble};
\draw[fill=olive!25!white](\xmax+0.05, \xmax-0.15) circle(0.02) node[right]{ : Static coalescence};



\end{tikzpicture}


\endpgfgraphicnamed



%%%STATIC DEACTIVATION


\beginpgfgraphicnamed{suppression}


\begin{tikzpicture}[scale=4.0, every node/.style={scale=0.9}]


%%%%Site deactivation

\tikzmath{
\ray=0.15;
\xmin = -0.1;
\xmax = 1.05;
};

\draw (\xmin,\xmin)--(\xmin,\xmax)--(\xmax,\xmax)--(\xmax,\xmin)--cycle;


%%IMPOSSIBLE BUBBLES

\draw[fill=red!15!white](0.21,0.77) circle(\ray) node{$\times$}; %node{$\redmath{\bm{\times}}$};

\draw[fill=red!15!white](0.28,0.16) circle(\ray) node{$\times$};% node{$\redmath{\bm{\times}}$};

%%OTHER BUBBLES

\draw(0.17,0.69) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.17,0.69) circle(\ray);
\draw(0.17,0.69) node{$\times$};


\draw(0.35,0.21) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.35,0.21) circle(\ray);
\draw(0.35,0.21) node{$\times$};


\draw(0.49,0.61) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.49,0.61) circle(\ray);
\draw(0.49,0.61) node{$\times$};


\draw(0.72,0.13) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.72,0.13) circle(\ray);
\draw(0.72,0.13) node{$\times$};


\draw(0.73,0.82) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.73,0.82) circle(\ray);
\draw(0.73,0.82) node{$\times$};

%%OTHER SITES

\draw(0.02,0.13) node{$\times$};

\draw(0.80,0.42) node{$\times$};

\draw(0.5,0.90) node{$\times$};

\draw(0.10,0.38) node{$\times$};


%%ARROW

\draw[->, >=latex,thick,black] (\xmax + 0.05, {\xmax/2})--++(0.3,0);


%%RIGHT PICTURE

\tikzmath{
\ray=0.15;
\xminb = {\xmax + 0.4};
\delt = {(\xmax - \xmin)};
\xshift = {\delt + 0.4};
};

\draw (\xminb,\xmin)--(\xminb,\xmax)--({\xminb+\delt},\xmax)--({\xminb+\delt},\xmin)--cycle;


%%OTHER BUBBLES

\draw(0.17+\xshift,0.69) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.17+\xshift,0.69) circle(\ray);
\draw(0.17+\xshift,0.69) node{$\times$};


\draw(0.35+\xshift,0.21) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.35+\xshift,0.21) circle(\ray);
\draw(0.35+\xshift,0.21) node{$\times$};


\draw(0.49+\xshift,0.61) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.49+\xshift,0.61) circle(\ray);
\draw(0.49+\xshift,0.61) node{$\times$};


\draw(0.72+\xshift,0.13) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.72+\xshift,0.13) circle(\ray);
\draw(0.72+\xshift,0.13) node{$\times$};


\draw(0.73+\xshift,0.82) circle(\ray);
\fill[color = gray!15!white, opacity=0.5] (0.73+\xshift,0.82) circle(\ray);
\draw(0.73+\xshift,0.82) node{$\times$};
\draw[<->, >=latex](0.73, 0.82)--++(\ray,0) node[midway, below]{$R_{d}$};

%%OTHER SITES

\draw(0.02+\xshift,0.13) node{$\times$};

\draw(0.80+\xshift,0.42) node{$\times$};

\draw(0.5+\xshift,0.90) node{$\times$};

\draw(0.10+\xshift,0.38) node{$\times$};



%%DEACTIVATED BUBBLES

\draw[fill=red!15!white](0.21+\xshift,0.77) node{$\redmath{\bm{\times}}$};

\draw[fill=red!15!white](0.28+ \xshift,0.16) node{$\redmath{\bm{\times}}$};



%%Legend
\tikzmath{
\legshift=0.1;
}

\draw(\xmax+\xshift, \xmax-0.05) circle(0) node[right]{$\times$ : Active site};
\draw(\xmax+\xshift, \xmax-0.15) circle(0) node[right]{$\redmath{\bm{\times}}$ : Deactivated site};



\end{tikzpicture}

\endpgfgraphicnamed
%
%
%\beginpgfgraphicnamed{slide_area}
%
\begin{tikzpicture}[scale=4.0]


%%Quenched Area

\tikzmath{\rayd=0.15; \raylo=0.3; \lsl=1.0;}; 

\coordinate (Od) at (2, 1);
\coordinate (Ol) at ($(Od)+(0,\lsl)$);
\coordinate (Rd) at ($(Od)+(\rayd,0.0)$);
\coordinate (Ld) at ($(Od)+(- \rayd,0)$);
\coordinate (Rl) at ($(Ol)+(\raylo,0.0)$);
\coordinate (Ll) at ($(Ol)+(- \raylo, 0.0)$);
%arc(-90:-90+180:0.6)

\draw[black, dashed] (Ld) arc(180:360:\rayd) -- (Rl) arc(360:360+180:\raylo) -- cycle;
\shade[bottom color=orange!90!blue, top color=red!90!blue, opacity=0.3] (Ld) arc(180:360:\rayd) -- (Rl) arc(360:360+180:\raylo) -- cycle;
%\shade[bottom color=orange!90!blue, top color=red!90!blue, opacity=0.3](Ol) circle(\raylo);
%\shade[bottom color=orange!90!blue, top color=red!90!blue, opacity=0.3](Od) circle(\rayd);
%\draw[black] (Tl) arc(90:90-180:0.6);


\draw[densely dotted] (Ld) arc(180:0:\rayd);
\draw[densely dotted] (Ll) arc(180:360:\raylo);

\draw[<->, >=stealth, densely dashed] (Od)--(Rd) node[midway, below]{$R_{d}$};
\draw[<->, >=stealth, densely dashed] (Ol)--(Rl) node[midway, above]{$R_{lo}$};

\draw[<->, >=stealth, densely dashed] (Od)--(Ol) node[midway, left]{$l_{sl}$};

\coordinate (Ow1) at (1.5,0.5);
\coordinate (Ow2) at (1.5,3);
\coordinate (Ow3) at (2.5,3);
\coordinate (Ow4) at (2.5,0.5);

%\draw (Ow1) -- (Ow2) -- (Ow3) -- (Ow4) -- cycle;
%\draw ($(Od)+(0,-0.5)$) node{Case 2 : $R_{lo} - R_{d} \leq l_{sl} \leq R_{lo}+R_{d}$};


\end{tikzpicture}

%\endpgfgraphicnamed



%\beginpgfgraphicnamed{deb_sketch}


\fbox{

\begin{tikzpicture}[scale=2.0]

\tikzmath{\length=4.0; \diam=0.6;};

\coordinate (A1) at (0,0);
\coordinate (A2) at ($(A1) + (0,\length)$);
\coordinate (B1) at (\diam,0);
\coordinate (B2) at ($(B1)+(0,\length)$);

\fill[top color = blue!5!white, bottom color = blue!20!white] (A1)--(A2)--(B2)--(B1)--cycle;

\draw (A1) -- (A2);
\draw (B1) -- (B2);

%Inlet water
\draw [->, >=latex, blue!70!black] ($(A1)+({\diam / 2},-0.2)$) --++ (0,0.4) node[very near start, right]{$G_{L}$};


%Applied heat flux
\tikzmath{\lheat=3.5;};

\foreach \z in {0,...,4}
{
\coordinate (P1) at (0,{0.5 + \z * \lheat / 5});
\coordinate (P2) at (\diam, {0.5 + \z * \lheat / 5});

\draw[->, >=latex, red!80!black] ($(P1)+(-0.4,0)$) -- (P1);
\draw[->, >=latex, red!80!black] ($(P2)+(0.4,0)$) -- (P2);

}


\draw[red!80!black] (0,{\length / 2}) node[left]{$\phi_{w}$};
\draw[red!80!black] (\diam,{\length / 2}) node[right]{$\phi_{w}$};

%Measurement section
\draw[brown!50!black, densely dashed, line width=2] (P1)--(P2);

\draw[->, >=latex, brown!30!black] ($(P2)+(0.4,0.4)$)--($(P2)+(0.02,0.02)$)  node[very near start, above right]{\footnotesize{Measurements}};

%Heating length
\draw[black, densely dashed, <->,>=latex] ($(A1)+(-0.5,0.5)$) -- ($(P1) + (-0.5,0)$) node[midway,left]{$3.5~$m};

%Radisu
\draw[black, densely dashed, <->,>=latex] (A2)--(B2) node[midway,above]{$19.2~$mm};

%Bubbles before MV
\tikzmath{\lpremv=\lheat ;};
\tikzmath{\bubrad=0.02;};
\foreach \i in {1,...,150}
{

\draw[fill=gray!10!white] ({\bubrad+rnd*(\diam-2*\bubrad)}, { \lpremv / 4 + rnd*3*\lpremv /4}) circle(\bubrad);

}




\end{tikzpicture}



}

%\endpgfgraphicnamed






%\beginpgfgraphicnamed{deb_prom}
%
\fbox{

\begin{tikzpicture}[scale=2.0]

\tikzmath{\length=4.0; \diam=0.6;};

\coordinate (A1) at (0,0);
\coordinate (A2) at ($(A1) + (0,\length)$);
\coordinate (B1) at (\diam,0);
\coordinate (B2) at ($(B1)+(0,\length)$);

\fill[top color = blue!5!white, bottom color = blue!20!white] (A1)--(A2)--(B2)--(B1)--cycle;

\draw (A1) -- (A2);
\draw (B1) -- (B2);

%Inlet water
\draw [->, >=latex, blue!70!black] ($(A1)+({\diam / 2},-0.2)$) --++ (0,0.4) node[very near start, right]{$G_{L}$};


%Applied heat flux
\tikzmath{\lheat=3.5;};

\foreach \z in {0,...,4}
{
\coordinate (P1) at (0,{0.5 + \z * \lheat / 5});
\coordinate (P2) at (\diam, {0.5 + \z * \lheat / 5});

\draw[->, >=latex, red!80!black] ($(P1)+(-0.4,0)$) -- (P1);
\draw[->, >=latex, red!80!black] ($(P2)+(0.4,0)$) -- (P2);

}


\draw[red!80!black] (0,{\length / 2}) node[left]{$\phi_{w}$};
\draw[red!80!black] (\diam,{\length / 2}) node[right]{$\phi_{w}$};

%Measurement section
\draw[brown!50!black, densely dashed, line width=2] (P1)--(P2);

\draw[->, >=latex, brown!50!black] ($(P2)+(0.4,0.4)$)--($(P2)+(0.02,0.02)$)  node[very near start, above right]{\footnotesize{Measurements}};

%Heating length
\draw[black, densely dashed, <->,>=latex] ($(A1)+(-0.5,0.5)$) -- ($(P1) + (-0.5,0)$) node[midway,left]{$L_{heat}$};

%Mixing Vanes
\tikzmath{\lmv = 2.5;};
\coordinate (Omv) at (0,\lmv);
\coordinate (Omv2) at (\diam , \lmv);


\draw[black, line width=1.0] (Omv)--++(\diam,0);
\draw[black, line width=1.0] ($(Omv)+(0,+0.05)$)--++(\diam,0);
\draw[black, line width=1.0] ($(Omv)+(0,+0.05)$)--++(35:\diam /2);
\draw[black, line width=1.0] ($(Omv2)+(0,+0.05)$)--++(-35+180:\diam /2);

%LMV
\draw[black, densely dashed, <->, >=latex] ($(Omv2)+(0.5,0)$) -- ($(P2) + (0.5,0)$) node[midway, right]{$L_{MV}$};


%Bubbles before MV
\tikzmath{\lpremv=\lheat - (\lheat - \lmv);};
\tikzmath{\bubrad=0.02;};
\foreach \i in {1,...,100}
{

\draw[fill=gray!10!white] ({\bubrad+rnd*(\diam-2*\bubrad)}, { \lpremv / 4 + rnd*3*\lpremv /4}) circle(\bubrad);

}

%Bubbles after MV
\tikzmath{\lpostmv=\lmv + 0.3;};
\tikzmath{\bubrad=0.02;};
\foreach \i in {1,...,60}
{

\draw[fill=gray!10!white] ( {\bubrad+rnd*(\diam/2 - 2*\bubrad) + \diam/4}, { \lpostmv + rnd*(\length - \lpostmv)} ) circle(\bubrad);

}



\end{tikzpicture}


}

%\endpgfgraphicnamed



%\beginpgfgraphicnamed{agate_mes_ax}


\fbox{

\begin{tikzpicture}[scale=10]

\tikzmath{\length=1.4; \diam=0.192; \yshift=-0.2;};

\coordinate (A1) at (0,{\yshift * 2});
\coordinate (A2) at ($(A1) + (0,\length)$);
\coordinate (B1) at (\diam,{\yshift * 2});
\coordinate (B2) at ($(B1)+(0,\length)$);

\fill[color = blue!5!white] (A1)--(A2)--(B2)--(B1)--cycle;

\draw (A1) -- (A2);
\draw (B1) -- (B2);

%Inlet water
\draw [->, >=latex, blue!70!black] ($(A1)+({\diam / 2},-\diam / 3)$) --++ (0,\diam/2) node[very near start, right]{$G_{L}$};



%Measurement section
\foreach \i in {-78, -52, -26, -10, 10, 26, 39, 52, 78, 104, 156, 229}
{

\draw[red!70!black, densely dashed, line width=1.5] (0,{\i * 2 / 100 * \diam})--++(\diam,0);
if

}

\draw (\diam, {-78 * 2 / 100 * \diam}) node[right]{$z=-7.8\ D_{h}$};
\draw (\diam, {-52 * 2 / 100 * \diam}) node[right]{$z=-5.2\ D_{h}$};
\draw (\diam, {-26 * 2 / 100 * \diam}) node[right]{$z=-2.6\ D_{h}$};
\draw (\diam, {-10 * 2 / 100 * \diam}) node[right]{$z=-1.6,\ -1.3,\ -1\ \text{and}\ -0.9\ D_{h}$};

\draw (\diam, {10 * 2 / 100 * \diam}) node[right]{$z=0.8\ \text{and}\ 1.0\ D_{h}$};
%\draw (\diam, {16 * 2 / 100 * \diam}) node[right]{$z=1.6\ D_{h}$};

%\draw (\diam, {21 * 2 / 100 * \diam}) node[right]{$z=2.1\ D_{h}$};

\draw (\diam, {26 * 2 / 100 * \diam}) node[right]{$z=1.6,\ 2.1\ \text{and}\ 2.6\ D_{h}$};

\draw (\diam, {39 * 2 / 100 * \diam}) node[right]{$z=3.9\ D_{h}$};

\draw (\diam, {52 * 2 / 100 * \diam}) node[right]{$z=5.2\ D_{h}$};

\draw (\diam, {78 * 2 / 100 * \diam}) node[right]{$z=7.8\ D_{h}$};

\draw (\diam, {104 * 2 / 100 * \diam}) node[right]{$z=10.4\ D_{h}$};

\draw (\diam, {156 * 2 / 100 * \diam}) node[right]{$z=15.6\ D_{h}$};

\draw (\diam, {229 * 2 / 100 * \diam}) node[right]{$z=22.9\ D_{h}$};

%\draw[brown!50!black, densely dashed, line width=2] (P1)--(P2);
%
%\draw[->, >=latex, brown!50!black] ($(P2)+(0.4,0.4)$)--($(P2)+(0.02,0.02)$)  node[very near start, above right]{\footnotesize{Measurements}};


%Mixing Vanes
\tikzmath{\lmv =0;};
\coordinate (Omv) at (0,\lmv);
\coordinate (Omv2) at (\diam , \lmv);


\draw[black, line width=2.0] (Omv2)--(Omv) node[left]{Mixing Vanes: $z=0$: };
%\draw[black, line width=1.0] ($(Omv)+(0,+0.05)$)--++(\diam,0);
%\draw[black, line width=1.0] ($(Omv)+(0,+0.05)$)--++(35:\diam /2);
%\draw[black, line width=1.0] ($(Omv2)+(0,+0.05)$)--++(-35+180:\diam /2);



\end{tikzpicture}


}


%\endpgfgraphicnamed
%
%\beginpgfgraphicnamed{subchannel}
%
\begin{tikzpicture}[scale=300]

\tikzmath{\R=0.00475; \p=0.0126;};

\coordinate (A1) at (0,0);
\coordinate (A2) at (0,\p);
\coordinate (A3) at (\p,\p);
\coordinate (A4) at (\p,0);

\draw[black, dashed, fill=blue!10!white] (A1)--(A2)--(A3)--(A4)--cycle;

\draw[black, fill=gray!10!white] (A1) circle(\R);
\draw[black, fill=gray!10!white] (A2) circle(\R);
\draw[black, fill=gray!10!white] (A3) circle(\R);
\draw[black, fill=gray!10!white] (A4) circle(\R);

\draw[<->, >=latex] ($(A3)-(\R,0)$)--++(2*\R,0) node[midway, above]{$9.5\ $mm};

\draw[<->, >=latex] ($(A1)-(1.05*\R,0)$)--++(0,\p) node[midway, left]{$12.6\ $mm};


\end{tikzpicture}


%\endpgfgraphicnamed




%%%%%PWR BY GLORIA FACCANONI
%
%% Pressurized Water Reactor
%% Author: Gloria Faccanoni <http://www.science.unitn.it/~gloria/home.htm>
%
%\beginpgfgraphicnamed{pwr_sketch}
%\fbox{

%\usepackage[hmargin=1cm,vmargin=1cm]{geometry}


\centering
\begin{tikzpicture}[
        scale=0.7,
        annotline/.style = {stealth-},
        arrows1loop/.style={->,red},
        arrows2loop/.style={->,white},
        arrows3loop/.style={->,draw=Gray},
        every node/.style={scale=1.5}
    ]
\draw[draw=Gray,double=Gray!10,double distance=4pt]
    (12,12) to[out=135,in=45](0,12)--(0,0)--(22,0)--(22,12)--(12,12)--(12,0);
\node[text width=4cm, text centered,font=\small] at (6,13)
    {Containment\\structure};
% legend
\begin{scope}[yshift=-2cm]
    \filldraw[draw=red,fill=red!10] (1,0) rectangle ++(2,1);
    \node[text width=4cm, font=\small,right] at (3,0.5)
        {Primary loop\\(150 bar)};
    \filldraw[draw=blue,bottom color=blue!40,top color=Gray!30]
        (11,0) rectangle ++(2,1);
    \node[text width=4cm, font=\small,right] at (13,0.5)
        {Secondary loop\\(60 bar)};
    \filldraw[draw=Blue,fill=Blue!10] (21,0) rectangle ++(2,1);
    \node[text width=4cm, font=\small,right] at (23,0.5)
        {Cooling loop};
\end{scope}
% 2nd loop --------------------------------------------------------------------
\begin{scope}[xshift=7.25cm,yshift=3cm]
    % vessel left
    \filldraw[draw=blue,bottom color=blue!40,top color=Gray!30]
        (0,0) to[out=-20,in=200] (3.5,0) --
        (3.5,4.5) to[out=120,in=60] (0,4.5) -- (0,0);
    % vessel right
    \filldraw[draw=blue,bottom color=blue!40,top color=Gray!30,xshift=7cm]
        (0,0) to[out=-20,in=200] (3.5,0) --
        (3.5,5) to[out=120,in=60] (0,5) -- (0,0);
    % circuits
    \draw[draw=blue,double=blue!40,double distance=4pt]
      (1.75,-0.3) -- ++(0,-1) -- ++(7,0) -- ++(0,1);
    \draw[draw=blue,double=Gray!30,double distance=4pt]
        (1.75,5.38) -- ++(0,1) -- ++(4,0) -- ++(0,1) -- ++(3,0) -- ++(0,-1.5);
    % arrows
    \draw[arrows2loop] (3.5,-1.3) -- (3,-1.3);
    \draw[arrows2loop] (1.75,-0.9) -- (1.75,-0.4);
    \draw[arrows2loop] (4.5,6.38) -- (5,6.38);
    \draw[arrows2loop] (7,7.38) -- (7.5,7.38);
    \draw[arrows2loop] (8.75,6.4) -- (8.75,5.9);
    \draw[arrows2loop] (8.75,-0.4) -- (8.75,-0.9);
    %
    \foreach \x in {0.5,1,...,3}
        \draw[arrows2loop,xshift=7cm] (\x,3) -- (\x,2.5);
    % labels
    \draw[annotline] (2.5,-1.3) -- ++(3.5,1.3)
        node[text width=1cm,font=\small,above] {Liquid};
    \draw[annotline] (2.5,6.38) -- ++(3.5,-1.3)
        node[text width=1cm,font=\small,below] {Vapor};
    % pump
    \begin{scope}[xshift=160,yshift=-40]
        \filldraw[fill=Blue!20,draw=Blue] (0,0) circle (0.5cm);
        %\node[below,font=\small] at (0,-0.5) {Pump};
        \filldraw[fill=Blue!40,draw=Blue,yshift=-0.5cm]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
        \filldraw[fill=Blue!40,draw=Blue,yshift=+0.5cm,rotate=180]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
        \filldraw[fill=Blue!40,draw=Blue,xshift=+0.5cm,rotate=90]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
        \filldraw[fill=Blue!40,draw=Blue,xshift=-0.5cm,rotate=-90]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
    \end{scope}
    % generator ...
    \draw[xshift=6.5cm,draw=Gray,double=Gray!10,double distance=4pt] 
        (3,4) -- ++(2,0);
    \filldraw[xshift=6.5cm,fill=orange!10,draw=orange] 
        (1.8,4) -- (3.0,3.3) -- (3.0,4.7) -- cycle;
    \filldraw[xshift=6.5cm,fill=orange!10,draw=orange] 
        (1.5,4) -- (2.5,3.4) -- (2.5,4.6) -- cycle;
    \filldraw[xshift=6.5cm,fill=orange!10,draw=orange] 
        (1.2,4) -- (2  ,3.5) -- (2  ,4.5) -- cycle;
    \filldraw[xshift=6.5cm,fill=orange!10,draw=orange] 
        (4.5,3.3) rectangle (7.3,4.7);
    %labels
    \node[text width=3cm, text centered,font=\small] at (1.75,4) 
        {Steam\\ generator};%\\ (heat change)
    \node[text width=2cm, text centered,font=\small] at (8.8,5) {Turbine};
    \node[text width=2cm, text centered,font=\small] at (12.4,3) {Alternator};
    % transmission lines
    \node (aa) at (11.1,4.6) {};
    \node (bb) at (11.6,4.6) {};
    \node (cc) at (12.1,4.6) {};
    \node (dd) at (12.6,4.6) {};
    \node (ee) at (13.1,4.6) {};
    \node (ff) at (13.6,4.6) {};

\end{scope}
% 3 loop --------------------------------------------------------------------
\begin{scope}[xshift=23cm,yshift=1cm]
    % circuit
    \draw[draw=Blue,double=Blue!10,double distance=4pt]
      (1,2.5) -- ++(-8.5,0) -- ++(0,+1.5) -- ++(8.5,0);
    % arrows
    \draw[arrows3loop] (-5.5,2.5) -- (-6,2.5);
    \draw[arrows3loop] (-1.5,2.5) -- (-2,2.5);
    \draw[arrows3loop] (-6,4) -- (-5.5,4);
    \draw[arrows3loop] (-2,4) -- (-1.5,4);
    % tower
    \filldraw[draw=Gray,fill=Gray!20] (1,7) to[out=270,in=80]
                  (0,0) to[out=-20,in=200]
                  (6,0) to[out=100,in=270]
                  (5,7);
    \filldraw[draw=Gray,fill=Gray!40] (1,7) to[out=30,in=150]
                  (5,7) to[out=200,in=-20]
                  (1,7);
    % labels
    \node[text width=3cm, text centered,font=\small] at (3,3.5)
        {Cooling\\tower};
    \node[text width=2cm, text centered,font=\small] at (-3.5,1.5)
        {Cooling\\water};
    \node[text width=2cm, text centered,font=\small] at (-5.75,3.25)
        {Condenser};
    % pump
    \begin{scope}[xshift=-10,yshift=115]
        \filldraw[fill=purple!20,draw=purple] (0,0) circle (0.5cm);
        %\node[below,font=\small] at (0,-0.5) {Pump};
        \filldraw[fill=purple!40,draw=purple,yshift=-0.5cm]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
        \filldraw[fill=purple!40,draw=purple,yshift=+0.5cm,rotate=180]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
        \filldraw[fill=purple!40,draw=purple,xshift=+0.5cm,rotate=90]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
        \filldraw[fill=purple!40,draw=purple,xshift=-0.5cm,rotate=-90]
            (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
    \end{scope}
\end{scope}
%1 loop --------------------------------------------------------------------
\begin{scope}[xshift=2cm,yshift=4cm]
% Reactor vessel
\filldraw[draw=red,fill=red!10] (0,-0.5) to[out=-20,in=200]
              (3.5,-0.5) --
              (3.5,4.5) to[out=160,in=20]
              (0,4.5) --
              (0,-0.5);
% circuit
\draw[draw=red,double=red!10,double distance=4pt]
  (0.1,1) --  ++(-1,0) -- ++(0,-3) -- ++(5,0) -- ++(0,1.5) --
  ++(3,0) -- ++(0,2) -- ++(-3.7,0);
% Pressurizer
\draw[draw=red,double=red!10,double distance=4pt] (4.2,1.6) -- ++(0,0.8);
\filldraw[draw=Green,bottom color=red!40,top color=Green!20]
              (4,2.4) to[out=-20,in=200]
              (4.5,2.4) --
              (4.5,3.6) to[out=160,in=20]
              (3.9,3.6) --
              (3.9,2.4);
% arrows
\draw[arrows1loop] (-0.7,1) -- (-0.2,1);
\draw[arrows1loop] (-0.9,-0.5) -- (-0.9,0);
\draw[arrows1loop] (0.7,-2) -- (0.2,-2);
\draw[arrows1loop] (4.5,1.5) -- (5,1.5);
\draw[arrows1loop] (7.1,0.5) -- (7.1,0);
\draw[arrows1loop] (5.5,-0.5) -- (5,-0.5);

% pump
\begin{scope}[xshift=75,yshift=-55,fill=red!20,draw=red]
    \filldraw (0,0) circle (0.5cm);
    %\node[below,font=\small] at (0,-0.5) {Pump};
    \filldraw[yshift=-0.5cm] (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
    \filldraw[yshift=+0.5cm,rotate=180]
        (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
    \filldraw[xshift=+0.5cm,rotate=90]
        (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
    \filldraw[xshift=-0.5cm,rotate=-90]
        (0,0) arc (240:180:0.4cm)  arc (200:280:0.4cm) ;
\end{scope}
% reactor core
\filldraw[fill=red!30,draw=red] (0.7,0) rectangle (2.8,2);

% control rods
\foreach \x in {1.0,1.5,2.0,2.5}
  \draw[draw=Gray,double=Gray!50,double distance=0.5pt] (\x,0.3) -- (\x,3.7);

%labels
\draw[annotline] (0.6,0.5) -- ++(-3.3,-1.5)
    node[text width=1cm,font=\small,left] {Reactor core};
\node[text width=2cm, text centered,font=\small] at (1.75,5.4) {Vessel};
\draw[annotline] (0.9,2.8) -- ++(-3.3,1.5)
    node[text width=2cm, text centered,font=\small,left=-8pt] {Control\\rods};
%\draw[annotline] (4.2,3.7) -- ++(0.5,1.5);
    %node[text width=2cm, text centered,font=\small,above] {Pressurizer};
%\draw[annotline] (3.9,1.5) -- ++(1.3,-0.6);
    %node[text width=2.4cm, text centered,below=-2pt,font=\small];
        %{Water coolant (\unit{330}{\degreecelsius})};
%\draw[annotline] (-0.1,-2) -- ++(-0.3,-0.6);
   % node[text width=2.4cm, text centered,below=-2pt,font=\small];
        %{Water coolant (\unit{280}{\degreecelsius})};
\end{scope}
% clouds ----------------------------------
\begin{scope}[xshift=26cm,yshift=10cm, fill=blue!10, draw=Blue,
    decoration={bumps,segment length=0.5cm}]
    \filldraw[yshift=-1.5cm,rotate=-25,decorate]
        (0,0) -- ++(-0.4,1.25)-- ++(-0.1,0.75)-- ++(0.2,0.5)-- ++(0.3,0.5)--
        ++(0.3,-0.5)-- ++(0.2,-0.5)-- ++(-0.1,-0.75)-- ++(-0.4,-1.25);
    \filldraw[xshift=0.5cm,yshift=-2cm,rotate=-30,decorate]
        (0,0) -- ++(-0.4,1.25)-- ++(-0.1,0.75)-- ++(0.2,0.5)-- ++(0.3,0.5)--
        ++(0.3,-0.5)-- ++(0.2,-0.5)-- ++(-0.1,-0.75)-- ++(-0.4,-1.25);
    \filldraw[xshift=-1.05cm,yshift=-2.15cm,rotate=-20,decorate]
        (0,0) -- ++(-0.4,1.25)-- ++(-0.1,0.75)-- ++(0.2,0.5)-- ++(0.3,0.5)--
        ++(0.3,-0.5)-- ++(0.2,-0.5)-- ++(-0.1,-0.75)-- ++(-0.4,-1.25);
    %labels
    \node[text width=1cm, text centered,font=\small] at (0.2,1.75) {Water vapor};
\end{scope}

% palo della luce
%\begin{scope}[xscale=0.2,xshift=113cm,yshift=19cm,line width=1pt,Brown]
%    \draw (0,0) -- (-6,-6)
%          (0,0) -- ( 6,-6)
%          (-1,-1) -- ( 1,-1)
%          (-1,-1) -- ( 2,-2)
%          ( 1,-1) -- (-2,-2)
%          (-2,-2) -- ( 2,-2)
%          (-2,-2) -- ( 3,-3)
%          ( 2,-2) -- (-3,-3)
%          ( 3,-3) -- (-3,-3)
%          (-3,-3) -- ( 4,-4)
%          ( 3,-3) -- (-4,-4)
%          ( 4,-4) -- (-4,-4)
%          (-4,-4) -- ( 5,-5)
%          ( 4,-4) -- (-5,-5)
%          ( 5,-5) -- (-5,-5)
%          (-6,-6) -- ( 0,-5.2)
%          ( 6,-6) -- ( 0,-5.2);
%    \draw (-1.5,-1.5) -- (-4,-1.5) -- (-1,-1)
%          ( 1.5,-1.5) -- ( 4,-1.5) -- ( 1,-1);
%    \path (-4,-1.4) node (a) {}
%          ( 4,-1.4) node (b) {};
%    \draw[line width=1pt,Brown] (-3.5,-3.5) -- (-7.5,-3.5) -- (-3,-3)
%                                ( 3.5,-3.5) -- ( 7.5,-3.5) -- ( 3,-3);
%    \path (-7.5,-3.4) node (c) {}
%          ( 7.5,-3.4) node (d) {}
%          (-5.5,-3.4) node (e) {}
%          ( 5.5,-3.4) node (f) {};
%\end{scope}
% transmission lines
%\draw[dashed,Gray] (c) -- (aa)
%                   (a) -- (bb)
%                   (e) -- (cc)
%                   (b) -- (dd)
%                   (f) -- (ee)
%                   (d) -- (ff);
\end{tikzpicture}
%}


%\endpgfgraphicnamed
%
%
%\beginpgfgraphicnamed{energy_mix}

\def\angle{0}
\def\radius{4}
\def\cyclelist{{"orange","blue","red","green", "purple"}}
\newcount\cyclecount \cyclecount=-1
\newcount\ind \ind=-1
\begin{tikzpicture}[nodes = {font=\sffamily}, every node/.style={scale=1.5}]
  \foreach \percent/\name in {
      68.4/Nuclear,
      11.4/Hydro,
      9.4/Wind + Solar,
      8.5/Natural Gas + Oil + Coal,
      2.3/Other
    } {
      \ifx\percent\empty\else               % If \percent is empty, do nothing
        \global\advance\cyclecount by 1     % Advance cyclecount
        \global\advance\ind by 1            % Advance list index
        \ifnum4<\cyclecount                 % If cyclecount is larger than list
          \global\cyclecount=0              %   reset cyclecount and
          \global\ind=0                     %   reset list index
        \fi
        \pgfmathparse{\cyclelist[\the\ind]} % Get color from cycle list
        \edef\color{\pgfmathresult}         %   and store as \color
        % Draw angle and set labels
        \draw[fill={\color!50},draw={\color}] (0,0) -- (\angle:\radius)
          arc (\angle:\angle+\percent*3.6:\radius) -- cycle;
        \node at (\angle+0.5*\percent*3.6:0.7*\radius) {\percent\,\%};
        \node[pin=\angle+0.5*\percent*3.6:\name]
          at (\angle+0.5*\percent*3.6:\radius) {};
        \pgfmathparse{\angle+\percent*3.6}  % Advance angle
        \xdef\angle{\pgfmathresult}         %   and store in \angle
      \fi
    };
\end{tikzpicture}

%\endpgfgraphicnamed




%%%%BUBBLE TIME SCALES
%

\beginpgfgraphicnamed{cycle1}

\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.0,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}



%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[top color=blue!10!white, bottom color=red!10!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;

\fill[white] (cavC) circle(0.2);

\coordinate (Ob) at ($(O) + (2.5,0)$);

\fill[white] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep)--++(0,-1)--($(O)-(0,1)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep);
%\draw (cavC) node[below]{Before ONB : $t<0$};

\draw (O) node[left]{$T_{w}$};

\draw ($(O) + (0,2)$) node[left]{$T_{L}$};

\draw ($(O)+(0,0.2)$) node[left]{$T_{sat}$};
\draw[dashed, thick, green!60!black] ($(O)+(0,0.2)$)--($(sep)+(0,0.2)$);

\end{tikzpicture}

\endpgfgraphicnamed


\beginpgfgraphicnamed{cycle2}


\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.0,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}


%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[top color=blue!10!white, bottom color=red!40!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;

\fill[white] (cavC) circle(0.5);

%\coordinate (Ob) at ($(O) + (2.5,0)$);

\coordinate (Ob) at ($(O) + (2.6,0)$);

\tikzmath{\ray=0.5; \hei = 0; \alphrad = acos(\hei / \ray);};

\coordinate (Oarc) at (cavR);
%\draw[fill=white] (Oarc) arc({(pi/2-\alphrad) r}:{(3*pi/2-\alphrad) r}:\ray);

\draw[fill=white] (cavC) circle(0.5);

%Wall

\fill[white] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep)--++(0,-1)--($(O)-(0,1)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep);
%\draw (cavC) node[below]{ONB : $t=0$};

\draw (O) node[left]{$T_{w}$};

\draw ($(O) + (0,2)$) node[left]{$T_{L}$};

%\draw ($(O)+(0,0.2)$) node[left]{$T_{ONB}$};
%\draw[dashed, thick, orange!60!black] ($(O)+(0,0.2)$)--($(sep)+(0,0.2)$);

\draw ($(O)+(0,0.7)$) node[left]{$T_{sat}$};
\draw[dashed, thick, green!60!black] ($(O)+(0,0.7)$)--($(sep)+(0,0.7)$);

\end{tikzpicture}

\endpgfgraphicnamed



\beginpgfgraphicnamed{cycle3}


\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.0,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}


%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[top color=blue!10!white, bottom color=red!40!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;


%\coordinate (Ob) at ($(O) + (2.5,0)$);

\coordinate (Ob) at ($(O) + (2.6,0)$);

\tikzmath{\ray=0.5; \hei = 0; \alphrad = acos(\hei / \ray);};

\coordinate (Oarc) at (cavR);
%\draw[fill=white] (Oarc) arc({(pi/2-\alphrad) r}:{(3*pi/2-\alphrad) r}:\ray);

\draw[fill=white] ($(cavC) + (0,0.7)$) circle(0.5);
\fill[white] (cavC) circle(0.5);

%Wall

\fill[white] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep)--++(0,-1)--($(O)-(0,1)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep);
%\draw (cavC) node[below]{Departure : $t=t_{g,d}$, $R=K\sqrt{\eta_{L}t_{g,d} }$};


\draw (O) node[left]{$T_{w}$};

\draw ($(O) + (0,2)$) node[left]{$T_{L}$};


\draw ($(O)+(0,0.7)$) node[left]{$T_{sat}$};
\draw[dashed, thick, green!60!black] ($(O)+(0,0.7)$)--($(sep)+(0,0.7)$);


\end{tikzpicture}

\endpgfgraphicnamed




\newcounter{randarcs}


\beginpgfgraphicnamed{cycle4}

\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.0,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}


%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[top color=blue!10!white, bottom color=red!90!blue!5!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;


%\coordinate (Ob) at ($(O) + (2.5,0)$);

\coordinate (Ob) at ($(O) + (2.6,0)$);

\tikzmath{\ray=0.5; \hei = 0; \alphrad = acos(\hei / \ray);};

\coordinate (Oarc) at (cavR);
%\draw[fill=white] (Oarc) arc({(pi/2-\alphrad) r}:{(3*pi/2-\alphrad) r}:\ray);

\coordinate (Ob) at ($(cavC) + (1.0,0.7)$);
%\fill[blue!15!white] ($(Ob) +(0,0.5)$)--++(-1,0)--++(0,-1.0)--++(1,0)--cycle;

\draw[fill=white] (Ob) circle(0.5);
\draw[->=latex, thick, red] ($(cavC) + (1.5,0.7)$)--++(0.25,0) node[very near end, above]{\textcolor{red}{$\vect{U_{b}}$}};
\fill[white] (cavC) circle(0.2);

\coordinate (Ob) at ($(cavC) + (1.0,0.7)$);
\coordinate (w1) at ($(Ob)+(0,1.15*0.5)$);
\coordinate (w2) at ($(w1) + (-0.5,-0.2)$);
\coordinate (w3) at ($(w2) + (-0.2, -0.4)$);

\draw[blue, ->, >=latex]  plot [smooth, tension=1.0] coordinates {(w1) (w2) (w3)};



%%%%TURBULENCE QUENCHING
%\pgfmathsetseed{21}
%\foreach \X in {1,...,15}
%{\pgfmathsetmacro{\myx}{0.3+0.2*rnd}
%\pgfmathsetmacro{\myy}{0.3+0.2*rnd}
%\pgfmathsetmacro{\angA}{360*rnd}
%\pgfmathsetmacro{\radA}{0.1+0.1*rnd}
%\pgfmathsetmacro{\myxp}{\myx+\radA*cos(\angA)}
%\pgfmathsetmacro{\myyp}{\myy+\radA*sin(\angA)}
%\pgfmathsetmacro{\angB}{\angA-75+150*rnd}
%\pgfmathsetmacro{\radB}{\radA-0.1+0.2*rnd}
%\pgfmathsetmacro{\myxq}{\myxp+\radB*cos(\angB)}
%\pgfmathsetmacro{\myyq}{\myyp+\radB*sin(\angB)}
%\pgfmathsetmacro{\angC}{\angB-45+90*rnd}
%\pgfmathsetmacro{\radC}{\radB-0.1+0.2*rnd}
%\pgfmathsetmacro{\myxr}{\myxq+\radB*cos(\angC)}
%\pgfmathsetmacro{\myyr}{\myyq+\radB*sin(\angC)}
%%\typeout{\angA,\radA;\angB,\radB}
%\path[-{Latex},name path=test-arc, blue!70!black] plot[smooth,tension=1] 
%coordinates {(\myx,\myy) (\myxp,\myyp) (\myxq,\myyq) (\myxr,\myyr) };
%\def\HasIntersection{0}
%\ifnum\X>1
% \foreach \Y in {1,...,\number\value{randarcs}}
% {\path[name intersections={of=\Y-arc and test-arc,total=\t},
% /utils/exec=\ifnum\t>0
%  \xdef\HasIntersection{1}%\typeout{intersects}
% \fi];
% }
%\fi
%\ifnum\HasIntersection=0
%    \stepcounter{randarcs}
%    \draw[-{Latex[bend]}] 
%    plot[smooth,tension=1] coordinates {(\myx,\myy) (\myxp,\myyp)
%    (\myxq,\myyq)  (\myxr,\myyr)};
%    \path[name path global=\number\value{randarcs}-arc]
%    plot[smooth,tension=1] coordinates {(\myx,\myy) (\myxp,\myyp)
%    (\myxq,\myyq)  (\myxr,\myyr)} -- cycle;
%\fi}
%
%\tikzmath{\rayspi=0.1;};
%
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=20,yshift=4] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;\\
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=24,yshift=12] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;
%
%%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=25,yshift=6] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;\\
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=27,yshift=17] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;
%
%
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=30,yshift=3] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=34,yshift=10] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;
%
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=37,yshift=20] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;\\
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=44,yshift=24] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;



%Wall

\fill[white] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep)--++(0,-1)--($(O)-(0,1)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep);
%\draw (cavC) node[below]{After departure : $t>t_{g,d}$};

\draw (O) node[left]{$T_{w}$};

\draw ($(O) + (0,2)$) node[left]{$T_{L}$};
\end{tikzpicture}

\endpgfgraphicnamed



\beginpgfgraphicnamed{cycle5}

\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.0,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}



%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[top color=blue!10!white, bottom color=blue!10!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;

\fill[white] (cavC) circle(0.2);

\coordinate (Ob) at ($(O) + (2.5,0)$);

\fill[white] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep)--++(0,-1)--($(O)-(0,1)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep);
%\draw (cavC) node[below]{Wait period : $t>t_{g,d}$};

\draw (O) node[left]{$T_{w}$};

\draw ($(O) + (0,2)$) node[left]{$T_{L}$};

\end{tikzpicture}

\endpgfgraphicnamed


\beginpgfgraphicnamed{cycle6}

\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.0,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}



%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[top color=blue!10!white, bottom color=red!10!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;

\fill[white] (cavC) circle(0.2);

\coordinate (Ob) at ($(O) + (2.5,0)$);


\fill[white] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep)--++(0,-1)--($(O)-(0,1)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep);
%\draw (cavC) node[below]{TBL reconstruction : $t>t_{g,d}$};

\draw (O) node[left]{$T_{w}$};

\draw ($(O) + (0,2)$) node[left]{$T_{L}$};

\draw ($(O)+(0,0.2)$) node[left]{$T_{sat}$};
\draw[dashed, thick, green!60!black] ($(O)+(0,0.2)$)--($(sep)+(0,0.2)$);

\end{tikzpicture}

\endpgfgraphicnamed



\beginpgfgraphicnamed{cycle6}


\begin{tikzpicture}[scale=2.5]
\coordinate (O) at (0,0);
\coordinate (Oliq) at (0,0.1);
\coordinate (cavL) at ($(O)+(0.5,0)$);
\coordinate (cavC) at ($(cavL)+(-45:0.5)$);
\coordinate (cavR) at ($(cavC)+(+45:0.5)$);
\coordinate (Oend) at ($(cavR)+(0.5,0)$);
\coordinate (sep) at ($(Oend)+(1.0,0)+(0.05,0)$);

%coordinates {(1,1) (2,2) (4,-2) (3,2)}


%\draw[blue] plot [smooth, tension=0.3] coordinates {(Oliq) ($(cavL)+(0,0.1)$) ($(cavC)+(0,0.1)$) ($(cavR)+(0,0.1)$) ($(Oend)+(0,0.1)$)};

\fill[top color=blue!10!white, bottom color=red!40!white] (O)--(cavL)--(cavC)--(cavR)--(sep)--($(sep)+(0,2)$)--($(O)+(0,2)$)--cycle;

\fill[white] (cavC) circle(0.5);

%\coordinate (Ob) at ($(O) + (2.5,0)$);

\coordinate (Ob) at ($(O) + (2.6,0)$);

\tikzmath{\ray=0.5; \hei = 0; \alphrad = acos(\hei / \ray);};

\coordinate (Oarc) at (cavR);
%\draw[fill=white] (Oarc) arc({(pi/2-\alphrad) r}:{(3*pi/2-\alphrad) r}:\ray);

\draw[fill=white] (cavC) circle(0.5);

%Wall

\fill[white] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep)--++(0,-1)--($(O)-(0,1)$)--cycle;
\draw[line width=1pt] (O)--(cavL)--(cavC)--(cavR)--(Oend)--(sep);

%\draw (cavC) node[below]{New nucleation : $t=t_{g,d}+t_{w} = \dfrac{1}{f}$};

\draw (O) node[left]{$T_{w}$};

\draw ($(O) + (0,2)$) node[left]{$T_{L}$};
%
%\draw ($(O)+(0,0.2)$) node[left]{$T_{ONB}$};
%\draw[dashed, thick, orange!60!black] ($(O)+(0,0.2)$)--($(sep)+(0,0.2)$);

\draw ($(O)+(0,0.7)$) node[left]{$T_{sat}$};
\draw[dashed, thick, green!60!black] ($(O)+(0,0.7)$)--($(sep)+(0,0.7)$);

\end{tikzpicture}

\endpgfgraphicnamed



%%%KURUL PODOWSKI HFP

\beginpgfgraphicnamed{kurul_hfp}

\fbox{

\begin{tikzpicture}[scale=3.0]

\coordinate (O) at (0,0);
\coordinate (A1) at (1,0);
\coordinate (A2) at (2,0);
\coordinate (A3) at (3,0);
\coordinate (A) at (3.5,0);


%Sections and wall
\draw (O) -- (A);
\draw ($(O)-(0,0.03)$) -- ($(A)-(0,0.03)$);
\foreach \i in {0,...,17}
{
\draw (\i*0.2,0) -- (\i*0.2+0.05,-0.03);
}

\fill[top color=blue!10!white, bottom color=red!10!white] (O)--(A)--++(0,1)--++(-3.5,0)--cycle;

%\draw[dashed, gray!70!white] (A1) --++ (0,1);
%\draw[dashed, gray!70!white] (A2) --++ (0,1);
%\draw[dashed, gray!70!white] (A3) --++ (0,1);


%Flow arrows
%\foreach \i in {1,...,12} 
%{
%\coordinate (Oloc) at ($(O)+(-0.1,\i/13)$);
%\draw[->,>=latex, gray!50!blue] (Oloc)--++({ln(1+0.05*\i)},0);
%}
%
%\draw ($(Oloc) + ({ln(1+0.05*12)},0)$) node[below right]{${\overline{U_{L}}}$};


%Liquid heat flux

\coordinate (Ophi) at (0.4,0);

\draw[->,>=latex, thick, blue!70!gray] ($(Ophi)+(0,-0.1)$)--($(Ophi)+(0,+0.1)$);
\draw ($(Ophi)+(0,-0.15)$) node{${\phi_{c,L}}$};


%Vapor convective flux
\coordinate (Ob) at (1.5,0);

\tikzmath{\alph = 40; \alphrad= \alph * pi / 180; \ray=0.2; \rw=\ray * sin(\alphrad r);};

\coordinate (Oarc) at ($(Ob)+(\rw,0)$);
\shade[ball color = gray!5!white, opacity = 1.0] (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

\draw (Oarc) arc({-(pi/2-\alphrad) r}:{(pi+pi/2-\alphrad) r}:\ray);

%\draw[red, thick, densely dashed] (Oarc) --++ (-2*\rw, 0);

\draw[->,>=latex, thick, brown!80!black] ($(Ob)+(0,-0.1)$)--($(Ob)+(0,+0.1)$);
\draw ($(Ob)+(0,-0.15)$) node{${\phi_{e}}$};



%Quenching heat flux

\coordinate (Ob2) at (3.0,0.5);
\tikzmath{\ray=0.25;};

\fill[blue!15!white, opacity=0.7] ($(Ob2)-(\ray,0)$)--++(2*\ray,0)--++(0,-0.5)--++(-2*\ray,0)--cycle;

\shade[ball color = gray!5!white, opacity = 1.0] (Ob2) circle(\ray);
\draw (Ob2) circle(\ray);

\coordinate (w1) at ($(Ob2)+(-1.1*\ray,1.1*\ray)$);
\coordinate (w2) at ($(w1) + (0,-0.6)$);
\coordinate (w3) at ($(w2) + (0.2,0)$);

\draw[blue, ->, >=latex]  plot [smooth, tension=1.0] coordinates {(w1) (w2) (w3)};

\coordinate (w1) at ($(Ob2)+(+1.1*\ray,1.1*\ray)$);
\coordinate (w2) at ($(w1) + (0,-0.6)$);
\coordinate (w3) at ($(w2) + (-0.2,0)$);

\draw[blue, ->, >=latex]  plot [smooth, tension=1.0] coordinates {(w1) (w2) (w3)};



\tikzmath{\rayspi=0.08;};

%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=80,yshift=3] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;
%\draw[->,>=stealth,gray!50!blue] plot[domain=0:3.2,smooth,xshift=90,yshift=3] ({(\x *pi) r}:{\rayspi*(1-\x/6)}) ;


\coordinate (Ophiq) at ($(Ob2) - (0,0.5)$);
\draw[->,>=latex, thick, orange!90!gray] ($(Ophiq)+(0,-0.1)$)--($(Ophiq)+(0,+0.1)$);
\draw ($(Ophiq)+(0,-0.15)$) node{${\phi_{q}}$};


\end{tikzpicture}

}

\endpgfgraphicnamed
%
%




%%%PROGRESSIVE FORCE BALANCE

\beginpgfgraphicnamed{bdf_prog} %%IN COMMAND LINE : pdflatex --jobname=forces draw.tex
%
%
\fbox{


\begin{tikzpicture}[scale=3.5, every node/.style={scale=0.9}]


%%%%Truncated sphere on a vertical wall


%Tilted bubble
\coordinate (Ob2) at (2.5,1.0);

\coordinate (O1) at (2.5,0);
\coordinate (O2) at (2.5,2);
\draw (O1)--(O2);

\tikzmath{\thet = 40; \thetrad= \thet * pi / 180;
\dthet=10; \dthetrad=\dthet*pi/180;
\thetadvrad=\thetrad - \dthetrad;
\thetrecrad=\thetrad + \dthetrad;
\thetadv=\thetadvrad*180/pi;
\thetrec=\thetrecrad*180/pi;
\ray=0.5; 
\rayadv=\ray *(1+cos(\thetrad r))/(1+ cos(\thetadvrad r);
\rayrec=\ray *(1+cos(\thetrad r))/(1+ cos(\thetrecrad r);};

\coordinate (Oarc) at ($(Ob2)-(0,{\ray * sin(\thetrad r)})$);


\draw (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);

%Upstream angle
\draw (Oarc) --++(-90+\thetrecrad r:0.3) node[very near end, below]{$\theta + \dtheta$};
\draw ($(Oarc)+(0,-0.15)$) arc(-90:-90+\thetrecrad r:0.15) ;

%Downstream angle
\coordinate (Oarc2) at ($(Oarc) + (0,{\rayadv * sin(\thetadvrad r) + \rayrec * sin(\thetrecrad r)})$);
\draw (Oarc2) --++({90-(\thetadvrad r)}:0.3);
\coordinate (angadv) at ($(Oarc2) +({90-(\thetadvrad r)}:0.3)$);
\draw (angadv)  node[above]{$\theta - \dtheta $};
\draw ($(Oarc2)+(0,+0.15)$) arc(90:{90-(\thetadvrad r)}:0.15);



%Center and radius

\coordinate (Cb) at ($(Oarc2)+( {\ray * cos(\thetrad r)} , {-0.5 * (\rayadv * sin(\thetadvrad r) + \rayrec  * sin(\thetrecrad r) )})$);
\draw (Cb) node{$\times$} node[below right]{$O$};

\draw[densely dashed, <->, >=latex] (Cb) -- (Oarc) node[midway, above left]{$R$};


\draw[densely dashed, <->, >=latex] ($(Oarc) + (-\ray/12,+\ray/15) $) -- ($(Oarc2) + (-\ray/12,-\ray/6) $) node[midway, left]{$d_{w}$};



%Inclination angle

\draw[densely dotted] (Cb) --++ (\ray,0);
\draw[densely dotted] (Cb) --++ ({(1*\dthetrad r)}: \ray );
\draw ($(Cb) + (0.3,0)$) arc(0: {(\dthetrad r)}:0.3)  node[very near end, above]{$\dtheta$};





%%Forces

\draw[->, >=latex, violet!70!black] (Ob2)--++(\ray/2,0) node[near end, above]{$\vect{F_{CP}}$};

\draw[->, >=latex, red!70!black!] ($(Cb)+(\ray,0)$)--++(\ray/2,0) node[very near end, above]{$\vect{F_{L}}$};
\draw[->, >=latex, red!70!black!] ($(Cb)+({sin(5)},{cos(5)*\rayrec*1.04})$)--++(0,+\ray/2) node[very near end, right]{$\vect{F_{D}}$};
\draw[->, >=latex, red] ($(Cb)+(0,+\rayrec*1.04)$)--++(0,+\ray/1.5) node[very near end, left]{$\vect{U_{b}}$};


\draw[->, >=latex, violet] (Oarc)--++(90+\thetrec:\ray/2) node[very near end, left]{$\vect{F_{C}}$};
\draw[->, >=latex, violet] (Oarc2)--++(-90-\thetadv:\ray/2) node[very near end, left]{$\vect{F_{C}}$};

\draw[->, >=latex, blue!70!black] (Cb)--++(0,\ray/1.5) node[very near end, right]{$\vect{F_{B}}$};


\draw[->, >=latex, green!50!black!] (Cb)--++(160-\thet:\ray/1.5) node[very near end, above]{$\vect{F_{AM}}$};

%Gravity

\draw[->, >=latex, blue!30!black]  ($(Cb)+({1.5*\ray},{1.5*\ray})$)--++(0,-\ray/2) node[very near end, right]{$\vect{g}$};



%Flow arrows
\foreach \i in {2,...,14} 
{
\coordinate (Oloc) at ($(O1)+(\i/15,0.05)$);
\draw[->,>=latex, gray!70!blue] (Oloc)--++(0,{ln(1+0.03*\i)});
}
\draw[gray!70!blue] ($(Oloc)+(0.1,0.1)$) node{$\vect{U_{L}}$};

%%Referential vectors
\coordinate (Ovect) at (4.0,0);
\draw[->, >=latex] (Ovect)--++(0.3,0) node[very near end, above right]{$\vect{e_{y}}$};
\draw[->, >=latex] (Ovect)--++(0,0.3) node[very near end, above right]{$\vect{e_{x}}$};

%Control volume

\coordinate (Oarc) at ($(Ob2)-(0,{\ray * sin(\thetrad r)})$);
\coordinate (Oarcb) at ($(Oarc)+(-\thetrecrad r : 0.15*\rayrec)$);

\draw[thick] (Oarc) arc({-pi+(\thetrecrad)) r}:{0 r}:\rayrec) arc ({0 r}:{pi-(\thetadvrad)) r}:\rayadv);
\draw[dotted, green!50!black, opacity=0.7, line width = 3pt] (Oarcb) arc({-pi+(1.15*\thetrecrad)) r}:{0.3 r}:1.01*\rayrec) arc ({0.3 r}:{ 0.93*(pi-(\thetadvrad)) r}:1.01*\rayadv)--cycle;

\end{tikzpicture}

}


\endpgfgraphicnamed



\end{document}


